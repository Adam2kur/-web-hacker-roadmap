<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zero to Master Web Hacker Roadmap - Deep Edition</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üîê</text></svg>">
    
    <!-- ALL CSS EMBEDDED HERE - Mobile First Design -->
    <style>
        /* ===== CSS RESET & BASE VARIABLES ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Dark theme (default) */
            --primary-bg: #0a0a0a;
            --secondary-bg: #1a1a1a;
            --tertiary-bg: #252525;
            --text-primary: #f0f0f0;
            --text-secondary: #b0b0b0;
            --text-tertiary: #888;
            --accent-green: #00ff88;
            --accent-blue: #4dabf7;
            --accent-amber: #ffb74d;
            --accent-red: #ff6b6b;
            --accent-purple: #9c27b0;
            --accent-orange: #ff9800;
            --accent-yellow: #ffeb3b;
            --border-color: #333;
            --shadow-sm: 0 1px 3px rgba(0,0,0,0.3);
            --shadow-md: 0 4px 6px rgba(0,0,0,0.4);
            --shadow-lg: 0 10px 15px rgba(0,0,0,0.5);
            --radius-sm: 4px;
            --radius-md: 8px;
            --radius-lg: 12px;
            --sidebar-width: 320px;
            --sidebar-width-mobile: 280px;
            --topbar-height: 60px;
            --topbar-height-mobile: 56px;
            --transition: all 0.3s ease;
            --monospace: 'Courier New', Courier, monospace;
            --sans-serif: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
        }

        [data-theme="light"] {
            --primary-bg: #ffffff;
            --secondary-bg: #f8f9fa;
            --tertiary-bg: #e9ecef;
            --text-primary: #212529;
            --text-secondary: #495057;
            --text-tertiary: #6c757d;
            --accent-green: #28a745;
            --accent-blue: #007bff;
            --accent-amber: #fd7e14;
            --accent-red: #dc3545;
            --accent-purple: #6f42c1;
            --accent-orange: #e36209;
            --accent-yellow: #ffc107;
            --border-color: #dee2e6;
            --shadow-sm: 0 1px 3px rgba(0,0,0,0.1);
            --shadow-md: 0 4px 6px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 15px rgba(0,0,0,0.1);
        }

        /* ===== BASE TYPOGRAPHY & LAYOUT ===== */
        body {
            font-family: var(--sans-serif);
            background-color: var(--primary-bg);
            color: var(--text-primary);
            line-height: 1.6;
            transition: var(--transition);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-x: hidden;
        }

        h1, h2, h3, h4, h5, h6 {
            font-weight: 600;
            line-height: 1.3;
            margin-bottom: 1rem;
        }

        h1 {
            font-size: clamp(1.75rem, 5vw, 2.5rem);
            color: var(--accent-green);
            border-bottom: 2px solid var(--accent-green);
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
            word-wrap: break-word;
        }

        h2 {
            font-size: clamp(1.5rem, 4vw, 2rem);
            color: var(--accent-blue);
            margin-top: 1.5rem;
        }

        h3 {
            font-size: clamp(1.25rem, 3.5vw, 1.5rem);
            color: var(--accent-amber);
            margin-top: 1.25rem;
        }

        h4 {
            font-size: clamp(1.1rem, 3vw, 1.25rem);
            color: var(--text-secondary);
            margin-top: 1rem;
        }

        p {
            margin-bottom: 1rem;
            word-wrap: break-word;
        }

        a {
            color: var(--accent-blue);
            text-decoration: none;
            transition: var(--transition);
        }

        a:hover {
            color: var(--accent-green);
            text-decoration: underline;
        }

        code, .code-block {
            font-family: var(--monospace);
            background-color: var(--tertiary-bg);
            padding: 0.2rem 0.4rem;
            border-radius: var(--radius-sm);
            font-size: 0.9em;
            border: 1px solid var(--border-color);
            word-break: break-all;
        }

        pre {
            background-color: var(--secondary-bg);
            padding: 1rem;
            border-radius: var(--radius-md);
            overflow-x: auto;
            margin: 1rem 0;
            border: 1px solid var(--border-color);
        }

        pre code {
            background: none;
            padding: 0;
            border: none;
            word-break: normal;
            white-space: pre-wrap;
        }

        ul, ol {
            margin-left: 1.5rem;
            margin-bottom: 1rem;
        }

        li {
            margin-bottom: 0.5rem;
        }

        /* ===== LAYOUT CONTAINERS ===== */
        .container {
            display: flex;
            flex: 1;
            position: relative;
            width: 100%;
            min-height: calc(100vh - var(--topbar-height));
        }

        /* ===== TOP NAVIGATION BAR ===== */
        .topbar {
            height: var(--topbar-height);
            background-color: var(--secondary-bg);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 1rem;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: var(--shadow-sm);
            width: 100%;
        }

        .topbar-title {
            font-size: clamp(0.9rem, 3vw, 1.25rem);
            font-weight: bold;
            color: var(--accent-green);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            flex-shrink: 1;
            min-width: 0;
        }

        .topbar-title span:last-child {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .topbar-controls {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            flex-shrink: 0;
        }

        .progress-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .progress-bar {
            width: 80px;
            height: 6px;
            background-color: var(--tertiary-bg);
            border-radius: 3px;
            overflow: hidden;
            flex-shrink: 0;
        }

        .progress-fill {
            height: 100%;
            background-color: var(--accent-green);
            width: 0%;
            transition: width 0.3s ease;
        }

        /* ===== SIDEBAR NAVIGATION ===== */
        .sidebar {
            width: var(--sidebar-width);
            background-color: var(--secondary-bg);
            border-right: 1px solid var(--border-color);
            height: calc(100vh - var(--topbar-height));
            position: fixed;
            left: 0;
            top: var(--topbar-height);
            overflow-y: auto;
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 900;
            transform: translateX(0);
            will-change: transform;
            -webkit-overflow-scrolling: touch;
        }

        .sidebar-content {
            padding: 1rem;
            height: 100%;
        }

        .phases-list {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            height: 100%;
        }

        .phase-item {
            margin-bottom: 1rem;
        }

        .phase-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem;
            background-color: var(--tertiary-bg);
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: var(--transition);
            border-left: 3px solid var(--accent-blue);
            -webkit-tap-highlight-color: transparent;
        }

        .phase-header:hover {
            background-color: var(--border-color);
        }

        .phase-header.active {
            border-left-color: var(--accent-green);
            background-color: rgba(0, 255, 136, 0.1);
        }

        .phase-title {
            font-weight: bold;
            font-size: 0.85rem;
            color: var(--text-primary);
            flex: 1;
            min-width: 0;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .phase-progress {
            font-size: 0.75rem;
            color: var(--text-tertiary);
            flex-shrink: 0;
            margin-left: 0.5rem;
        }

        .topics-list {
            margin-top: 0.5rem;
            margin-left: 0.5rem;
            display: none;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .topics-list.expanded {
            display: block;
            max-height: 1000px;
        }

        .topic-item {
            padding: 0.5rem;
            margin-bottom: 0.25rem;
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.85rem;
            -webkit-tap-highlight-color: transparent;
        }

        .topic-item:hover {
            background-color: var(--tertiary-bg);
        }

        .topic-item.active {
            background-color: rgba(77, 171, 247, 0.1);
            color: var(--accent-blue);
            font-weight: bold;
        }

        .checkbox-group {
            margin: 1rem 0;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
            cursor: pointer;
            -webkit-tap-highlight-color: transparent;
        }

        .checkbox-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
            flex-shrink: 0;
        }

        /* ===== MAIN CONTENT AREA ===== */
        .main-content {
            flex: 1;
            padding: 1.5rem;
            margin-left: var(--sidebar-width);
            width: 100%;
            max-width: 1400px;
            min-height: calc(100vh - var(--topbar-height));
            transition: margin-left 0.3s ease, padding 0.3s ease;
        }

        .content-section {
            background-color: var(--secondary-bg);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-md);
            width: 100%;
            overflow-wrap: break-word;
        }

        /* ===== SPECIAL CONTENT BOXES ===== */
        .callout {
            padding: 1rem;
            border-radius: var(--radius-md);
            margin: 1.5rem 0;
            border-left: 4px solid;
            word-wrap: break-word;
        }

        .callout-why {
            background-color: rgba(77, 171, 247, 0.1);
            border-left-color: var(--accent-blue);
        }

        .callout-why h4 {
            color: var(--accent-blue);
            margin-top: 0;
        }

        .callout-misconception {
            background-color: rgba(255, 107, 107, 0.1);
            border-left-color: var(--accent-red);
        }

        .callout-misconception h4 {
            color: var(--accent-red);
            margin-top: 0;
        }

        .callout-exercise {
            background-color: rgba(255, 183, 77, 0.1);
            border-left-color: var(--accent-amber);
        }

        .callout-exercise h4 {
            color: var(--accent-amber);
            margin-top: 0;
        }

        .callout-principle {
            background-color: rgba(0, 255, 136, 0.1);
            border-left-color: var(--accent-green);
            font-style: italic;
        }

        .callout-example {
            background-color: rgba(156, 39, 176, 0.1);
            border-left-color: var(--accent-purple);
        }

        .callout-example h4 {
            color: var(--accent-purple);
            margin-top: 0;
        }

        /* ===== DIAGRAM STYLES ===== */
        .diagram {
            margin: 1.5rem 0;
            padding: 1rem;
            background-color: var(--primary-bg);
            border-radius: var(--radius-md);
            border: 1px solid var(--border-color);
            overflow-x: auto;
        }

        .data-flow-diagram {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
            min-width: min-content;
        }

        .flow-node {
            padding: 1rem;
            border: 2px solid var(--border-color);
            border-radius: var(--radius-md);
            text-align: center;
            min-width: min(150px, 100%);
            position: relative;
            word-break: break-word;
        }

        .flow-node.client {
            border-color: var(--accent-blue);
            background-color: rgba(77, 171, 247, 0.1);
        }

        .flow-node.server {
            border-color: var(--accent-green);
            background-color: rgba(0, 255, 136, 0.1);
        }

        .flow-node.database {
            border-color: var(--accent-amber);
            background-color: rgba(255, 183, 77, 0.1);
        }

        .flow-arrow {
            width: 0;
            height: 0;
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-top: 15px solid var(--text-tertiary);
        }

        .trust-boundary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(min(200px, 100%), 1fr));
            gap: 1rem;
            padding: 1rem;
            border: 2px dashed var(--accent-red);
            border-radius: var(--radius-md);
            margin: 1.5rem 0;
        }

        .trust-zone {
            padding: 1rem;
            border-radius: var(--radius-sm);
            text-align: center;
            word-break: break-word;
        }

        .trust-zone.high {
            background-color: rgba(0, 255, 136, 0.2);
            border: 1px solid var(--accent-green);
        }

        .trust-zone.low {
            background-color: rgba(255, 107, 107, 0.2);
            border: 1px solid var(--accent-red);
        }

        /* ===== EXERCISE STYLES ===== */
        .exercise {
            margin: 1.5rem 0;
            padding: 1rem;
            background-color: var(--tertiary-bg);
            border-radius: var(--radius-md);
            border: 1px solid var(--border-color);
            word-wrap: break-word;
        }

        .exercise-header {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .exercise-level {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: bold;
            align-self: flex-start;
        }

        .level-beginner {
            background-color: rgba(77, 171, 247, 0.2);
            color: var(--accent-blue);
        }

        .level-intermediate {
            background-color: rgba(255, 183, 77, 0.2);
            color: var(--accent-amber);
        }

        .level-advanced {
            background-color: rgba(255, 107, 107, 0.2);
            color: var(--accent-red);
        }

        .exercise-goal {
            font-weight: bold;
            color: var(--accent-green);
            margin-bottom: 0.5rem;
        }

        .exercise-expected {
            font-style: italic;
            color: var(--text-secondary);
            margin-top: 0.5rem;
        }

        /* ===== NOTES SECTION ===== */
        .notes-section {
            margin-top: 2rem;
            padding: 1.5rem;
            background-color: var(--secondary-bg);
            border-radius: var(--radius-lg);
            border: 1px solid var(--border-color);
            width: 100%;
        }

        .notes-textarea {
            width: 100%;
            min-height: 150px;
            padding: 1rem;
            background-color: var(--primary-bg);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            font-family: var(--sans-serif);
            font-size: 1rem;
            resize: vertical;
            margin: 1rem 0;
        }

        /* ===== BUTTON STYLES ===== */
        button {
            padding: 0.5rem 1rem;
            background-color: var(--tertiary-bg);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: var(--transition);
            font-family: var(--sans-serif);
            font-size: 0.9rem;
            -webkit-tap-highlight-color: transparent;
        }

        button:hover {
            background-color: var(--border-color);
        }

        button.primary {
            background-color: var(--accent-blue);
            color: white;
            border-color: var(--accent-blue);
        }

        button.primary:hover {
            background-color: #3d9df5;
        }

        button.success {
            background-color: var(--accent-green);
            color: #000;
            border-color: var(--accent-green);
        }

        button.success:hover {
            background-color: #00e676;
        }

        .theme-toggle {
            background: none;
            border: none;
            font-size: 1.25rem;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 0.5rem;
            min-width: 44px;
            min-height: 44px;
        }

        .theme-toggle:hover {
            color: var(--text-primary);
        }

        .sidebar-toggle {
            display: none;
            background: none;
            border: none;
            font-size: 1.25rem;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 0.5rem;
            min-width: 44px;
            min-height: 44px;
        }

        /* ===== TABLE STYLES ===== */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }

        th {
            background-color: var(--tertiary-bg);
            padding: 0.75rem;
            text-align: left;
            border: 1px solid var(--border-color);
            font-weight: 600;
        }

        td {
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            vertical-align: top;
        }

        tr:hover {
            background-color: rgba(255, 255, 255, 0.05);
        }

        /* ===== OVERLAY FOR MOBILE ===== */
        .sidebar-overlay {
            display: none;
            position: fixed;
            top: var(--topbar-height);
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 899;
            backdrop-filter: blur(2px);
        }

        /* ===== RESPONSIVE DESIGN ===== */

        /* Large tablets and small laptops (1024px and below) */
        @media (max-width: 1024px) {
            .sidebar {
                width: var(--sidebar-width-mobile);
                transform: translateX(-100%);
            }
            
            .sidebar.active {
                transform: translateX(0);
                box-shadow: var(--shadow-lg);
            }
            
            .sidebar.active ~ .sidebar-overlay {
                display: block;
            }
            
            .main-content {
                margin-left: 0;
                padding: 1.25rem;
            }
            
            .sidebar-toggle {
                display: block;
            }
            
            .content-section {
                padding: 1.25rem;
            }
        }

        /* Tablets (768px and below) */
        @media (max-width: 768px) {
            :root {
                --topbar-height: var(--topbar-height-mobile);
            }
            
            .topbar {
                padding: 0 0.75rem;
            }
            
            .topbar-title {
                font-size: 0.95rem;
            }
            
            .progress-indicator {
                font-size: 0.8rem;
            }
            
            .progress-bar {
                width: 70px;
            }
            
            .main-content {
                padding: 1rem;
            }
            
            .content-section {
                padding: 1rem;
                border-radius: var(--radius-md);
            }
            
            .notes-section {
                padding: 1rem;
            }
            
            .trust-boundary {
                grid-template-columns: 1fr;
                padding: 0.75rem;
            }
            
            .data-flow-diagram {
                gap: 0.75rem;
            }
            
            .flow-node {
                padding: 0.75rem;
                width: 100%;
            }
            
            h1 {
                font-size: 1.5rem;
                margin-bottom: 1rem;
            }
            
            h2 {
                font-size: 1.35rem;
            }
            
            h3 {
                font-size: 1.2rem;
            }
        }

        /* Small tablets and large phones (600px and below) */
        @media (max-width: 600px) {
            .topbar-controls {
                gap: 0.5rem;
            }
            
            .progress-indicator span:first-child {
                display: none;
            }
            
            .progress-bar {
                width: 60px;
            }
            
            .main-content {
                padding: 0.75rem;
            }
            
            .content-section {
                padding: 0.75rem;
            }
            
            .callout {
                padding: 0.75rem;
                margin: 1rem 0;
            }
            
            .exercise {
                padding: 0.75rem;
                margin: 1rem 0;
            }
            
            .notes-textarea {
                min-height: 120px;
                padding: 0.75rem;
            }
        }

        /* Mobile phones (480px and below) */
        @media (max-width: 480px) {
            .topbar {
                padding: 0 0.5rem;
            }
            
            .topbar-title {
                font-size: 0.85rem;
            }
            
            .topbar-controls {
                gap: 0.25rem;
            }
            
            .theme-toggle,
            .sidebar-toggle {
                padding: 0.25rem;
                font-size: 1.1rem;
            }
            
            .main-content {
                padding: 0.5rem;
            }
            
            .content-section {
                padding: 0.75rem;
                margin-bottom: 1.5rem;
            }
            
            .notes-section {
                padding: 0.75rem;
                margin-top: 1.5rem;
            }
            
            .diagram {
                padding: 0.75rem;
                margin: 1rem 0;
            }
            
            button {
                padding: 0.5rem 0.75rem;
                font-size: 0.85rem;
            }
            
            pre {
                padding: 0.75rem;
                font-size: 0.9em;
            }
            
            code, .code-block {
                font-size: 0.85em;
                padding: 0.15rem 0.3rem;
            }
        }

        /* Small mobile phones (320px and below) */
        @media (max-width: 320px) {
            .topbar {
                height: 52px;
                padding: 0 0.375rem;
            }
            
            .topbar-title {
                font-size: 0.8rem;
                gap: 0.25rem;
            }
            
            .topbar-title span:first-child {
                display: none;
            }
            
            .progress-bar {
                width: 50px;
                height: 5px;
            }
            
            .main-content {
                padding: 0.375rem;
            }
            
            .content-section {
                padding: 0.625rem;
                border-radius: var(--radius-sm);
            }
            
            h1 {
                font-size: 1.35rem;
                padding-bottom: 0.375rem;
            }
            
            h2 {
                font-size: 1.2rem;
                margin-top: 1rem;
            }
            
            h3 {
                font-size: 1.1rem;
                margin-top: 0.75rem;
            }
            
            .sidebar {
                width: 85vw;
                max-width: 280px;
            }
            
            .phase-header {
                padding: 0.625rem;
            }
            
            .phase-title {
                font-size: 0.8rem;
            }
            
            .topic-item {
                padding: 0.375rem;
                font-size: 0.8rem;
            }
            
            .checkbox-item {
                font-size: 0.8rem;
            }
            
            .checkbox-item input[type="checkbox"] {
                width: 16px;
                height: 16px;
            }
            
            .notes-textarea {
                min-height: 100px;
                padding: 0.625rem;
                font-size: 0.9rem;
            }
            
            .flow-node {
                padding: 0.625rem;
                font-size: 0.9rem;
            }
            
            .trust-zone {
                padding: 0.625rem;
                font-size: 0.9rem;
            }
        }

        /* Landscape mode for mobile */
        @media (max-height: 500px) and (orientation: landscape) {
            .topbar {
                height: 50px;
            }
            
            .sidebar {
                height: calc(100vh - var(--topbar-height));
                overflow-y: auto;
            }
            
            .main-content {
                min-height: auto;
                padding: 0.75rem;
            }
            
            .notes-textarea {
                min-height: 80px;
            }
        }

        /* High DPI screens */
        @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
            button,
            .theme-toggle,
            .sidebar-toggle {
                min-height: 44px;
                min-width: 44px;
            }
            
            .checkbox-item input[type="checkbox"] {
                transform: scale(1.1);
                transform-origin: left center;
            }
        }

        /* Print styles */
        @media print {
            .sidebar,
            .topbar,
            .sidebar-toggle,
            .theme-toggle,
            .notes-section,
            button {
                display: none !important;
            }
            
            .main-content {
                margin-left: 0 !important;
                padding: 0 !important;
                width: 100% !important;
            }
            
            .content-section {
                box-shadow: none !important;
                border: 1px solid #ddd !important;
                page-break-inside: avoid;
            }
            
            body {
                background-color: white !important;
                color: black !important;
            }
            
            pre, code {
                background-color: #f5f5f5 !important;
                border-color: #ddd !important;
            }
        }

        /* ===== UTILITY CLASSES ===== */
        .hidden {
            display: none !important;
        }

        .visible {
            display: block !important;
        }

        .text-center {
            text-align: center;
        }

        .mt-1 { margin-top: 0.5rem; }
        .mt-2 { margin-top: 1rem; }
        .mt-3 { margin-top: 1.5rem; }
        .mt-4 { margin-top: 2rem; }

        .mb-1 { margin-bottom: 0.5rem; }
        .mb-2 { margin-bottom: 1rem; }
        .mb-3 { margin-bottom: 1.5rem; }
        .mb-4 { margin-bottom: 2rem; }

        /* ===== ANIMATIONS ===== */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }

        /* ===== SCROLLBAR STYLING ===== */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--secondary-bg);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-tertiary);
        }

        /* Smooth scrolling for the whole page */
        html {
            scroll-behavior: smooth;
        }

        /* Improve touch scrolling on mobile */
        @media (pointer: coarse) {
            .sidebar,
            .main-content {
                -webkit-overflow-scrolling: touch;
            }
            
            button,
            .phase-header,
            .topic-item {
                min-height: 44px;
            }
            
            .checkbox-item {
                min-height: 44px;
                padding: 0.5rem 0;
            }
        }

        /* Fix for iOS Safari viewport height */
        @supports (-webkit-touch-callout: none) {
            .sidebar {
                height: -webkit-fill-available;
                height: fill-available;
            }
            
            .container {
                min-height: -webkit-fill-available;
                min-height: fill-available;
            }
        }
    </style>
</head>
<body>
    <!-- TOP NAVIGATION BAR -->
    <nav class="topbar">
        <div class="topbar-title">
            <span>üîê</span>
            <span>Zero to Master Web Hacker Roadmap</span>
        </div>
        <div class="topbar-controls">
            <div class="progress-indicator">
                <span id="progress-text">0% Complete</span>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
            </div>
            <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                üåì
            </button>
            <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
                ‚ò∞
            </button>
        </div>
    </nav>

    <!-- MAIN CONTAINER -->
    <div class="container">
        <!-- SIDEBAR NAVIGATION -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-content">
                <div class="phases-list" id="phases-list">
                    <!-- Phases will be populated by JavaScript -->
                </div>
            </div>
        </aside>
        
        <!-- OVERLAY FOR MOBILE SIDEBAR -->
        <div class="sidebar-overlay" id="sidebar-overlay"></div>

        <!-- MAIN CONTENT AREA -->
        <main class="main-content" id="main-content">
            <!-- Content will be dynamically loaded here -->
        </main>
    </div>

    <!-- ALL JAVASCRIPT EMBEDDED HERE -->
    <script>
        // ===== GLOBAL DATA STRUCTURE =====
        // Complete roadmap data with DEEP explanations for every topic
        const roadmapData = {
            corePrinciples: [
                "Understand before exploit: Master the system before attempting to find vulnerabilities",
                "Manual before tools: Learn to do everything manually first to build intuition",
                "Build before break: Create applications to understand how they should work",
                "Depth over speed: Prioritize deep understanding over quick results",
                "Discipline over motivation: Consistency beats bursts of enthusiasm"
            ],
            
            phases: [
                {
                    id: "phase-0",
                    title: "PHASE 0 ‚Äî HOW COMPUTERS REALLY WORK (FOUNDATION)",
                    topics: [
                        {
                            id: "topic-0-1",
                            title: "What is a computer (CPU, RAM, Storage)",
                            completed: false,
                            content: {
                                explanation: `
                                    <h3>üñ•Ô∏è The Computer System: A Layered Architecture</h3>
                                    <p>A computer is a system that processes information using three fundamental components that work together in a hierarchical architecture:</p>
                                    
                                    <div class="diagram">
                                        <div class="trust-boundary">
                                            <div class="trust-zone high">
                                                <strong>CPU (Central Processing Unit)</strong><br>
                                                <em>"The Brain"</em><br>
                                                ‚Ä¢ Executes instructions from programs<br>
                                                ‚Ä¢ Contains cores (parallel processing units)<br>
                                                ‚Ä¢ Has registers (ultra-fast temporary storage)<br>
                                                ‚Ä¢ Operates at GHz speeds (billions of cycles/second)<br>
                                                ‚Ä¢ Follows fetch-decode-execute cycle
                                            </div>
                                            <div class="trust-zone high">
                                                <strong>RAM (Random Access Memory)</strong><br>
                                                <em>"Short-term Memory"</em><br>
                                                ‚Ä¢ Volatile (loses data when powered off)<br>
                                                ‚Ä¢ Stores data currently in use<br>
                                                ‚Ä¢ Much faster than storage (nanoseconds vs milliseconds)<br>
                                                ‚Ä¢ Limited capacity (typically 8-64GB)<br>
                                                ‚Ä¢ Directly accessible by CPU
                                            </div>
                                            <div class="trust-zone low">
                                                <strong>Storage (HDD/SSD/NVMe)</strong><br>
                                                <em>"Long-term Memory"</em><br>
                                                ‚Ä¢ Non-volatile (persists without power)<br>
                                                ‚Ä¢ Stores operating system, programs, files<br>
                                                ‚Ä¢ Slower but much larger capacity<br>
                                                ‚Ä¢ HDD: Mechanical, 5,400-7,200 RPM<br>
                                                ‚Ä¢ SSD: Flash memory, no moving parts<br>
                                                ‚Ä¢ NVMe: PCIe-based, fastest option
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <h4>üìä The Memory Hierarchy (Fastest ‚Üí Slowest):</h4>
                                    <ol>
                                        <li><strong>CPU Registers</strong> (1-2 ns) - Built into CPU, holds current instruction data</li>
                                        <li><strong>CPU Cache</strong> (L1, L2, L3) (2-20 ns) - Small, fast memory on CPU chip</li>
                                        <li><strong>RAM</strong> (80-100 ns) - Main working memory</li>
                                        <li><strong>SSD Storage</strong> (50-150 Œºs) - Solid State Drive</li>
                                        <li><strong>HDD Storage</strong> (3-15 ms) - Hard Disk Drive</li>
                                        <li><strong>Network Storage</strong> (10-100 ms) - Cloud/remote storage</li>
                                    </ol>
                                    
                                    <h4>‚öôÔ∏è How They Work Together:</h4>
                                    <div class="diagram data-flow-diagram">
                                        <div class="flow-node">1. Program on Storage</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">2. Loaded into RAM</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">3. CPU fetches from RAM</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">4. CPU executes instructions</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">5. Results written to RAM</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">6. Saved to Storage if needed</div>
                                    </div>
                                    
                                    <p><strong>First Principles:</strong> At the lowest level, computers only understand binary (0s and 1s). Everything - programs, data, images, sound - is ultimately represented as patterns of bits. The CPU's instruction set defines what operations it can perform (add, subtract, move data, jump).</p>
                                    
                                    <h4>üîç Deep Dive: CPU Architecture</h4>
                                    <p>The CPU contains several critical components:</p>
                                    <ul>
                                        <li><strong>ALU (Arithmetic Logic Unit):</strong> Performs mathematical operations</li>
                                        <li><strong>Control Unit:</strong> Coordinates all CPU activities</li>
                                        <li><strong>Registers:</strong> Tiny storage locations (Program Counter, Instruction Register, Accumulator)</li>
                                        <li><strong>Cache:</strong> Multi-level memory (L1 smallest/fastest, L3 largest/slowest)</li>
                                    </ul>
                                    
                                    <div class="callout callout-example">
                                        <h4>üîç Real-World Security Scenario: Cold Boot Attack</h4>
                                        <p><strong>Problem:</strong> RAM is volatile but doesn't instantly lose data when power is removed. It takes several seconds to minutes for data to fade.</p>
                                        <p><strong>Attack:</strong> Attackers can freeze RAM chips with compressed air, then quickly transfer them to another machine to read the contents.</p>
                                        <p><strong>What's exposed:</strong> Encryption keys, passwords, sensitive documents that were "in memory" at the time.</p>
                                        <p><strong>Solution:</strong> Full-disk encryption with key in CPU (not RAM), memory encryption technologies.</p>
                                    </div>
                                    
                                    <h4>üéØ Key Security Insights:</h4>
                                    <ul>
                                        <li><strong>Data in RAM is accessible</strong> to any process with sufficient privileges</li>
                                        <li><strong>Storage persists</strong> even after "deletion" (just marks space as available)</li>
                                        <li><strong>CPU cache timing</strong> can leak information (side-channel attacks)</li>
                                        <li><strong>Memory isolation</strong> between processes is a security boundary</li>
                                    </ul>
                                `,
                                whyItMatters: `
                                    <div class="callout callout-why">
                                        <h4>üõ°Ô∏è Why This Deep Understanding Matters</h4>
                                        <p>When you understand computers at the hardware level, you can:</p>
                                        <ul>
                                            <li><strong>Comprehend advanced attacks:</strong> Rowhammer (corrupting RAM), Spectre/Meltdown (CPU cache timing), DMA attacks (direct memory access)</li>
                                            <li><strong>Understand security controls:</strong> ASLR (Address Space Layout Randomization), DEP (Data Execution Prevention), NX bit (No eXecute)</li>
                                            <li><strong>Perform effective forensics:</strong> Know where to look for evidence (RAM vs storage)</li>
                                            <li><strong>Write secure code:</strong> Understand memory management pitfalls</li>
                                            <li><strong>Reverse engineer:</strong> Read assembly language and understand CPU behavior</li>
                                        </ul>
                                        <p><strong>Example:</strong> Buffer overflow attacks work because the CPU can't distinguish between data and instructions in memory. Understanding the stack and heap helps you exploit AND prevent these vulnerabilities.</p>
                                        <p>This foundation separates tool-users who run scripts from researchers who discover new vulnerabilities.</p>
                                    </div>
                                `,
                                misconceptions: `
                                    <div class="callout callout-misconception">
                                        <h4>‚ùå Common Misconceptions Debunked</h4>
                                        <p><strong>Myth:</strong> "When I delete a file, it's gone."</p>
                                        <p><strong>Reality:</strong> Deletion typically just removes the pointer to the data. The actual bits remain on storage until overwritten. This is why file recovery is possible and why secure deletion requires overwriting.</p>
                                        
                                        <p><strong>Myth:</strong> "The CPU processes everything directly."</p>
                                        <p><strong>Reality:</strong> The CPU only works with data in registers and cache. Everything else must be loaded into cache/RAM first. This hierarchy creates timing differences that enable side-channel attacks.</p>
                                        
                                        <p><strong>Myth:</strong> "More RAM always means better performance."</p>
                                        <p><strong>Reality:</strong> Beyond what's needed for active programs, extra RAM provides diminishing returns. The bottleneck is often CPU cache or storage speed, not RAM capacity.</p>
                                        
                                        <p><strong>Security Impact:</strong> These misunderstandings lead to false security assumptions. Thinking deleted files are truly gone creates data exposure risks.</p>
                                    </div>
                                `,
                                examples: [
                                    {
                                        title: "Real-World Scenario: Password in Memory",
                                        description: "When you type a password, it exists in RAM while being processed. If an application stores it in plaintext in memory, other processes or memory dumps might capture it. This is why password managers use encrypted memory regions and zero out memory after use."
                                    },
                                    {
                                        title: "Real-World Scenario: Disk Encryption",
                                        description: "Full-disk encryption (like BitLocker, FileVault) protects data at rest on storage. But when the system is running, decryption keys are in RAM. Cold boot attacks can capture these keys from RAM, bypassing the encryption."
                                    }
                                ],
                                exercises: [
                                    {
                                        level: "beginner",
                                        description: "Open Task Manager (Windows) or Activity Monitor (Mac) and System Monitor (Linux). Create a spreadsheet tracking 5 different applications. For each, document: CPU usage %, RAM usage (MB/GB), Disk activity, and Network activity. Observe what happens when you perform different actions with each app.",
                                        goal: "Visually correlate application behavior with resource usage",
                                        expected: "Spreadsheet with measurements and written observations about which resources different applications use most"
                                    },
                                    {
                                        level: "intermediate",
                                        description: "Write a simple Python program that creates a large list in memory (e.g., 1 million integers). Time how long it takes to: 1) Create the list, 2) Access random elements, 3) Process all elements. Then modify it to write/read from a file instead. Compare the timing differences.",
                                        goal: "Experience the performance difference between RAM and storage",
                                        expected: "Python script with timing measurements and analysis of RAM vs storage performance"
                                    },
                                    {
                                        level: "advanced",
                                        description: "Research and document the memory hierarchy of your specific CPU. Use tools like CPU-Z or dmidecode to find: L1/L2/L3 cache sizes, RAM type and speed, storage type (SSD/HDD/NVMe). Calculate the theoretical speed ratios between each level.",
                                        goal: "Understand your specific hardware capabilities and limitations",
                                        expected: "Detailed hardware specification document with analysis of potential bottlenecks"
                                    }
                                ],
                                mentalModels: `
                                    <div class="diagram data-flow-diagram">
                                        <div class="flow-node client">User Action (Click, Typing)</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">Input Devices ‚Üí Electrical Signals</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node server">CPU: Interprets as Instructions</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">RAM: Holds Active Data/Code</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node database">Storage: Persistent Data</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">Output Devices: Display/Sound</div>
                                    </div>
                                    <p><strong>Mental Model 1: The Restaurant Kitchen</strong></p>
                                    <ul>
                                        <li><strong>CPU = Chef:</strong> Can only work with ingredients at the counter</li>
                                        <li><strong>RAM = Kitchen Counter:</strong> Holds ingredients currently being used</li>
                                        <li><strong>Cache = Prep Bowls:</strong> Right next to the chef for immediate use</li>
                                        <li><strong>Storage = Pantry/Freezer:</strong> Holds all ingredients, takes time to retrieve</li>
                                        <li><strong>Network = Supplier Delivery:</strong> External source, slowest option</li>
                                    </ul>
                                    
                                    <p><strong>Mental Model 2: Office Worker</strong></p>
                                    <ul>
                                        <li><strong>CPU = Worker:</strong> Does the actual thinking/work</li>
                                        <li><strong>Registers = Hands:</strong> What's immediately being worked on</li>
                                        <li><strong>Cache = Desk:</strong> Frequently used documents within reach</li>
                                        <li><strong>RAM = Office:</strong> All active projects and files</li>
                                        <li><strong>Storage = Filing Cabinets/Storage Room:</strong> All documents, archived projects</li>
                                    </ul>
                                    
                                    <div class="callout callout-principle">
                                        <p><strong>First Principles Thinking:</strong> At the most fundamental level, computers manipulate electricity. Transistors (billions of them) act as switches (on/off, 1/0). These switches form logic gates (AND, OR, NOT). Logic gates form circuits that perform calculations. Everything builds up from there.</p>
                                    </div>
                                `
                            }
                        },
                        {
                            id: "topic-0-2",
                            title: "How programs execute",
                            completed: false,
                            content: {
                                explanation: `
                                    <h3>‚ö° Program Execution: From Code to Running Process</h3>
                                    <p>Program execution follows a specific lifecycle that transforms static code on disk into a dynamic, running process in memory:</p>
                                    
                                    <div class="diagram data-flow-diagram">
                                        <div class="flow-node">Source Code (Human-readable)</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">Compiler/Interpreter</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">Executable File (Machine code)</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">Loader (OS component)</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">Process in Memory</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">CPU Execution</div>
                                    </div>
                                    
                                    <h4>üìã The Complete Execution Lifecycle:</h4>
                                    <ol>
                                        <li><strong>Compilation/Interpretation:</strong>
                                            <ul>
                                                <li><strong>Compiled languages</strong> (C, C++, Go): Source code ‚Üí Machine code executable</li>
                                                <li><strong>Interpreted languages</strong> (Python, JavaScript, PHP): Source code ‚Üí Bytecode ‚Üí Runtime interpretation</li>
                                                <li><strong>Just-In-Time (JIT)</strong> (Java, .NET): Source code ‚Üí Bytecode ‚Üí JIT compilation at runtime</li>
                                            </ul>
                                        </li>
                                        
                                        <li><strong>Loading:</strong>
                                            <ul>
                                                <li>Operating system loads executable from storage into RAM</li>
                                                <li>Sets up process control block (PCB) - the OS's representation of the process</li>
                                                <li>Allocates memory segments: Text (code), Data (initialized variables), BSS (uninitialized), Heap, Stack</li>
                                                <li>Resolves dynamic library dependencies</li>
                                            </ul>
                                        </li>
                                        
                                        <li><strong>Initialization:</strong>
                                            <ul>
                                                <li>Runtime environment setup (if needed)</li>
                                                <li>Static variable initialization</li>
                                                <li>Entry point execution (main() function in C, __start in assembly)</li>
                                            </ul>
                                        </li>
                                        
                                        <li><strong>Execution:</strong>
                                            <ul>
                                                <li>CPU begins executing instructions at the program's entry point</li>
                                                <li>Program counter (PC) register tracks current instruction</li>
                                                <li>Stack pointer (SP) manages function calls and local variables</li>
                                                <li>Heap grows dynamically for malloc()/new allocations</li>
                                            </ul>
                                        </li>
                                        
                                        <li><strong>Interaction:</strong>
                                            <ul>
                                                <li>Program makes system calls for OS services (file I/O, network, etc.)</li>
                                                <li>May create threads for parallel execution</li>
                                                <li>Handles signals and interrupts</li>
                                            </ul>
                                        </li>
                                        
                                        <li><strong>Termination:</strong>
                                            <ul>
                                                <li>Normal exit via return from main() or exit() call</li>
                                                <li>Abnormal termination via signal (SIGSEGV, SIGKILL)</li>
                                                <li>OS reclaims resources: memory, file handles, process ID</li>
                                                <li>Exit status returned to parent process</li>
                                            </ul>
                                        </li>
                                    </ol>
                                    
                                    <h4>üîç Deep Dive: The Fetch-Decode-Execute Cycle</h4>
                                    <p>The CPU's fundamental operation cycle:</p>
                                    <div class="diagram">
                                        <div style="text-align: center; font-family: var(--monospace); background: var(--tertiary-bg); padding: 1rem; border-radius: var(--radius-md);">
                                            <strong>CPU Cycle (Billions per second):</strong><br>
                                            1. <strong>FETCH:</strong> Read instruction at Program Counter address<br>
                                            2. <strong>DECODE:</strong> Determine what operation to perform<br>
                                            3. <strong>EXECUTE:</strong> Perform the operation (add, move, jump)<br>
                                            4. <strong>UPDATE PC:</strong> Move to next instruction (or jump elsewhere)<br>
                                            Repeat until program ends
                                        </div>
                                    </div>
                                    
                                    <h4>üèóÔ∏è Process Memory Layout (Linux/Unix):</h4>
                                    <div class="diagram">
                                        <div style="font-family: var(--monospace); background: var(--tertiary-bg); padding: 1rem; border-radius: var(--radius-md);">
                                            <strong>High Addresses</strong><br>
                                            ‚Üì Kernel space (protected)<br>
                                            ‚Üì Stack (grows downward)<br>
                                            ‚Üì ... Free memory ...<br>
                                            ‚Üì ‚Üë Heap (grows upward)<br>
                                            ‚Üì BSS (uninitialized data)<br>
                                            ‚Üì Data (initialized variables)<br>
                                            ‚Üì Text (program code)<br>
                                            <strong>Low Addresses</strong>
                                        </div>
                                    </div>
                                    
                                    <p><strong>Key Segments:</strong></p>
                                    <ul>
                                        <li><strong>Text (Code):</strong> Read-only machine instructions</li>
                                        <li><strong>Data:</strong> Initialized global/static variables</li>
                                        <li><strong>BSS:</strong> Uninitialized global/static variables (Block Started by Symbol)</li>
                                        <li><strong>Heap:</strong> Dynamically allocated memory (malloc/free, new/delete)</li>
                                        <li><strong>Stack:</strong> Function calls, local variables, return addresses</li>
                                        <li><strong>Kernel:</strong> Operating system memory (not accessible to user programs)</li>
                                    </ul>
                                    
                                    <div class="callout callout-example">
                                        <h4>üîç Real-World Security Scenario: Code Injection</h4>
                                        <p><strong>Problem:</strong> If an attacker can write to memory that will be executed as code, they can hijack program execution.</p>
                                        <p><strong>Attack:</strong> Buffer overflow overwrites return address on stack to point to injected shellcode.</p>
                                        <p><strong>How it works:</strong> The CPU doesn't distinguish between "data" and "code" in memory. If the Program Counter points to attacker-controlled data, it gets executed as instructions.</p>
                                        <p><strong>Defenses:</strong> NX bit (No eXecute) marks memory as data-only, ASLR randomizes memory locations, stack canaries detect overflows.</p>
                                    </div>
                                    
                                    <h4>üîÑ System Calls: User Space ‚Üî Kernel Space</h4>
                                    <p>When a program needs OS services (file access, network, process creation), it makes a system call:</p>
                                    <div class="diagram data-flow-diagram">
                                        <div class="flow-node client">User Program: Call open()</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">Library Wrapper: Arranges arguments</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node" style="border-color: var(--accent-red);">TRAP: Switch to kernel mode</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node server">Kernel: Performs actual operation</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">Return to user mode with result</div>
                                    </div>
                                    
                                    <p><strong>Privilege Levels:</strong> Modern CPUs have multiple privilege rings (0-3). Ring 0 is kernel mode (full access). Ring 3 is user mode (restricted). System calls switch from ring 3 to ring 0.</p>
                                `,
                                whyItMatters: `
                                    <div class="callout callout-why">
                                        <h4>üõ°Ô∏è Why Understanding Program Execution Matters</h4>
                                        <p>This knowledge enables you to:</p>
                                        <ul>
                                            <li><strong>Understand exploitation techniques:</strong> Buffer overflows, return-oriented programming (ROP), code injection</li>
                                            <li><strong>Analyze malware:</strong> How malicious code executes and persists</li>
                                            <li><strong>Perform reverse engineering:</strong> Understand disassembled code and execution flow</li>
                                            <li><strong>Write secure code:</strong> Avoid common pitfalls in memory management</li>
                                            <li><strong>Debug complex issues:</strong> Use debuggers effectively with knowledge of stack traces and memory layout</li>
                                            <li><strong>Understand security features:</strong> ASLR, DEP, stack canaries, control-flow integrity</li>
                                        </ul>
                                        <p><strong>Example:</strong> Spectre/Meltdown vulnerabilities exploit speculative execution in CPUs. Understanding how CPUs execute instructions (out-of-order execution, branch prediction) is essential to grasp these attacks.</p>
                                        <p>Without this foundation, you're limited to running tools without understanding what they're doing or why vulnerabilities exist.</p>
                                    </div>
                                `,
                                misconceptions: `
                                    <div class="callout callout-misconception">
                                        <h4>‚ùå Common Misconceptions Debunked</h4>
                                        <p><strong>Myth:</strong> "When I run a program, the CPU reads it directly from disk."</p>
                                        <p><strong>Reality:</strong> The entire program is loaded into RAM first. The CPU only accesses RAM (and cache). Disk is thousands of times slower - direct execution would be impossibly slow.</p>
                                        
                                        <p><strong>Myth:</strong> "Interpreted languages like Python don't get compiled."</p>
                                        <p><strong>Reality:</strong> Python compiles to bytecode (.pyc files) which is then interpreted by the Python Virtual Machine (PVM). The bytecode is still machine instructions, just for a virtual machine rather than physical CPU.</p>
                                        
                                        <p><strong>Myth:</strong> "The 'stack' and 'heap' are physical parts of memory."</p>
                                        <p><strong>Reality:</strong> They're logical concepts. Both use the same physical RAM. The OS and runtime manage which addresses belong to stack vs heap. They're just different regions with different allocation patterns.</p>
                                        
                                        <p><strong>Myth:</strong> "System calls are just regular function calls."</p>
                                        <p><strong>Reality:</strong> System calls involve a privilege level switch (user‚Üíkernel), which is expensive and requires careful argument validation. This is why syscalls are batched when possible.</p>
                                    </div>
                                `,
                                exercises: [
                                    {
                                        level: "beginner",
                                        description: "Write a simple 'Hello World' program in C. Compile it with gcc using different flags: -g (debug), -O0 (no optimization), -O2 (optimization). Use the 'file' and 'size' commands to examine the resulting executables. Note the differences in file size and structure.",
                                        goal: "Understand the compilation process and resulting executable",
                                        expected: "Three compiled versions of Hello World with analysis of differences"
                                    },
                                    {
                                        level: "intermediate",
                                        description: "Write a program that demonstrates stack growth. Create recursive functions that print their stack frame addresses. Observe how the stack grows downward. Then write a program that dynamically allocates memory on the heap and prints those addresses. Compare the directions of growth.",
                                        goal: "Visualize stack and heap memory layout",
                                        expected: "Program showing stack addresses decreasing and heap addresses increasing"
                                    },
                                    {
                                        level: "advanced",
                                        description: "Use strace (Linux) or dtrace (Mac) to trace system calls of a simple program. Write a program that opens a file, reads content, and closes it. Capture all system calls. Analyze which calls are made, their arguments, and return values. Document the complete interaction with the OS.",
                                        goal: "Understand program-OS interaction through system calls",
                                        expected: "Complete system call trace with analysis of each call's purpose"
                                    }
                                ],
                                mentalModels: `
                                    <div class="diagram data-flow-diagram">
                                        <div class="flow-node">Recipe Book (Source Code)</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">Chef's Translation (Compilation)</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">Step-by-Step Cards (Executable)</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">Kitchen Setup (Loading)</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">Cooking Process (Execution)</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">Served Dish (Output)</div>
                                    </div>
                                    
                                    <p><strong>Mental Model 1: Theater Production</strong></p>
                                    <ul>
                                        <li><strong>Script = Source Code:</strong> Human-readable instructions</li>
                                        <li><strong>Director's Notes = Compilation:</strong> Translation for performers</li>
                                        <li><strong>Stage Directions = Executable:</strong> Precise instructions</li>
                                        <li><strong>Theater Setup = Loading:</strong> Stage, props, actors in position</li>
                                        <li><strong>Performance = Execution:</strong> Live action following script</li>
                                        <li><strong>Stage Crew = OS Kernel:</strong> Supports but stays behind scenes</li>
                                    </ul>
                                    
                                    <p><strong>Mental Model 2: Construction Project</strong></p>
                                    <ul>
                                        <li><strong>Blueprints = Source Code:</strong> Design documents</li>
                                        <li><strong>Materials List = Compilation:</strong> What's actually needed</li>
                                        <li><strong>Work Orders = Executable:</strong> Specific tasks</li>
                                        <li><strong>Job Site Setup = Loading:</strong> Materials delivered, crew assembled</li>
                                        <li><strong>Construction = Execution:</strong> Actual building process</li>
                                        <li><strong>Inspections = System Calls:</strong> Official approvals needed</li>
                                    </ul>
                                    
                                    <div class="callout callout-principle">
                                        <p><strong>First Principles Thinking:</strong> At the hardware level, program execution is just the CPU following a sequence of instructions stored as binary numbers in memory. Each instruction is a number that the CPU interprets as "add these registers" or "jump to this address." Everything else (variables, functions, objects) is built on top of this simple model.</p>
                                    </div>
                                `
                            }
                        },
                        {
                            id: "topic-0-3",
                            title: "Processes and threads",
                            completed: false,
                            content: {
                                explanation: `
                                    <h3>üßµ Processes and Threads: Concurrency and Isolation</h3>
                                    <p>Modern operating systems use processes and threads to manage concurrent execution and resource isolation:</p>
                                    
                                    <div class="diagram">
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                                            <div style="border: 3px solid var(--accent-blue); padding: 1.5rem; border-radius: var(--radius-md);">
                                                <h4 style="color: var(--accent-blue); margin-top: 0;">üè¢ PROCESS</h4>
                                                <p><strong>Definition:</strong> An instance of a running program with its own isolated memory space</p>
                                                <ul>
                                                    <li><strong>Isolated:</strong> Has private virtual address space</li>
                                                    <li><strong>Independent:</strong> Crash doesn't affect other processes</li>
                                                    <li><strong>Heavyweight:</strong> Expensive to create/destroy</li>
                                                    <li><strong>Protected:</strong> OS-mediated inter-process communication</li>
                                                    <li><strong>Examples:</strong> Each browser tab (in some browsers), separate applications</li>
                                                </ul>
                                            </div>
                                            <div style="border: 3px solid var(--accent-green); padding: 1.5rem; border-radius: var(--radius-md);">
                                                <h4 style="color: var(--accent-green); margin-top: 0;">üßµ THREAD</h4>
                                                <p><strong>Definition:</strong> A unit of execution within a process that shares memory with other threads</p>
                                                <ul>
                                                    <li><strong>Shared memory:</strong> All threads in process share address space</li>
                                                    <li><strong>Lightweight:</strong> Cheap to create/destroy</li>
                                                    <li><strong>Dependent:</strong> Crash can take down entire process</li>
                                                    <li><strong>Direct access:</strong> Threads can directly access shared data</li>
                                                    <li><strong>Examples:</strong> Background tasks in an app, parallel computations</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <h4>üîç Process Anatomy (Linux/Unix):</h4>
                                    <div class="diagram">
                                        <div style="font-family: var(--monospace); background: var(--tertiary-bg); padding: 1rem; border-radius: var(--radius-md);">
                                            <strong>Process ID 1234 (Chrome Browser)</strong><br>
                                            ‚îú‚îÄ‚îÄ Virtual Memory Space<br>
                                            ‚îÇ   ‚îú‚îÄ‚îÄ Text: Program code<br>
                                            ‚îÇ   ‚îú‚îÄ‚îÄ Data: Global variables<br>
                                            ‚îÇ   ‚îú‚îÄ‚îÄ Heap: Dynamic allocations<br>
                                            ‚îÇ   ‚îî‚îÄ‚îÄ Stack (per thread)<br>
                                            ‚îú‚îÄ‚îÄ File Descriptors<br>
                                            ‚îÇ   ‚îú‚îÄ‚îÄ 0: stdin<br>
                                            ‚îÇ   ‚îú‚îÄ‚îÄ 1: stdout<br>
                                            ‚îÇ   ‚îú‚îÄ‚îÄ 2: stderr<br>
                                            ‚îÇ   ‚îî‚îÄ‚îÄ 3+: files, sockets<br>
                                            ‚îú‚îÄ‚îÄ Process Control Block (PCB)<br>
                                            ‚îÇ   ‚îú‚îÄ‚îÄ PID, PPID<br>
                                            ‚îÇ   ‚îú‚îÄ‚îÄ User ID, Group ID<br>
                                            ‚îÇ   ‚îú‚îÄ‚îÄ State (running, waiting, etc.)<br>
                                            ‚îÇ   ‚îî‚îÄ‚îÄ Scheduling information<br>
                                            ‚îî‚îÄ‚îÄ Threads<br>
                                                ‚îú‚îÄ‚îÄ Thread 1: Main UI<br>
                                                ‚îú‚îÄ‚îÄ Thread 2: Network<br>
                                                ‚îî‚îÄ‚îÄ Thread 3: JavaScript
                                        </div>
                                    </div>
                                    
                                    <h4>üîÑ Process States Lifecycle:</h4>
                                    <div class="diagram data-flow-diagram">
                                        <div class="flow-node">New (Created)</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">Ready (Waiting for CPU)</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">Running (Executing on CPU)</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">Waiting (I/O, sleep)</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">Terminated (Finished)</div>
                                    </div>
                                    
                                    <h4>üßµ Thread vs Process Comparison:</h4>
                                    <table>
                                        <thead>
                                            <tr>
                                                <th>Aspect</th>
                                                <th>Process</th>
                                                <th>Thread</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td><strong>Isolation</strong></td>
                                                <td>Complete memory isolation</td>
                                                <td>Shared memory within process</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Creation Cost</strong></td>
                                                <td>High (MBs of memory, setup)</td>
                                                <td>Low (KBs, shares existing)</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Communication</strong></td>
                                                <td>IPC (pipes, sockets, shared mem)</td>
                                                <td>Direct memory access</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Crash Impact</strong></td>
                                                <td>Only this process affected</td>
                                                <td>Can crash entire process</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Security</strong></td>
                                                <td>Strong boundaries</td>
                                                <td>Weak boundaries (within process)</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Context Switch</strong></td>
                                                <td>Expensive (change memory maps)</td>
                                                <td>Cheap (same memory space)</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    
                                    <h4>‚öôÔ∏è How the OS Manages Concurrency:</h4>
                                    <ol>
                                        <li><strong>Scheduling:</strong> OS decides which process/thread runs on which CPU core</li>
                                        <li><strong>Context Switching:</strong> Saving/restoring CPU state when switching between tasks</li>
                                        <li><strong>Synchronization:</strong> Locks, semaphores to coordinate access to shared resources</li>
                                        <li><strong>Priority Management:</strong> Some processes get more CPU time (real-time vs background)</li>
                                    </ol>
                                    
                                    <div class="callout callout-example">
                                        <h4>üîç Real-World Security Scenario: Thread Safety Issues</h4>
                                        <p><strong>Problem:</strong> Multiple threads accessing shared data without synchronization can cause race conditions.</p>
                                        <p><strong>Example - Bank Account:</strong> Two threads simultaneously try to withdraw $100 from an account with $150.</p>
                                        <pre><code>Thread 1: Read balance = $150
Thread 2: Read balance = $150
Thread 1: Subtract $100 ‚Üí $50
Thread 2: Subtract $100 ‚Üí $50
Result: Balance = $50 (should be -$50, overdrawn!)</code></pre>
                                        <p><strong>Attack:</strong> Exploiting race conditions in security checks (TOCTTOU - Time Of Check To Time Of Use).</p>
                                        <p><strong>Defense:</strong> Proper synchronization (mutexes, semaphores), atomic operations, thread-safe data structures.</p>
                                    </div>
                                    
                                    <h4>üîó Inter-Process Communication (IPC) Methods:</h4>
                                    <div class="trust-boundary">
                                        <div class="trust-zone high">
                                            <strong>Pipes (| in shell)</strong><br>
                                            ‚Ä¢ Unidirectional byte stream<br>
                                            ‚Ä¢ Parent-child relationship<br>
                                            ‚Ä¢ Limited capacity<br>
                                            ‚Ä¢ <code>ls | grep "file"</code>
                                        </div>
                                        <div class="trust-zone high">
                                            <strong>Sockets</strong><br>
                                            ‚Ä¢ Network or local communication<br>
                                            ‚Ä¢ Bidirectional<br>
                                            ‚Ä¢ Can cross machine boundaries<br>
                                            ‚Ä¢ TCP/UDP protocols
                                        </div>
                                        <div class="trust-zone low">
                                            <strong>Shared Memory</strong><br>
                                            ‚Ä¢ Fastest IPC method<br>
                                            ‚Ä¢ Memory region mapped into multiple processes<br>
                                            ‚Ä¢ Requires synchronization<br>
                                            ‚Ä¢ Risk of race conditions
                                        </div>
                                        <div class="trust-zone high">
                                            <strong>Message Queues</strong><br>
                                            ‚Ä¢ Structured messages<br>
                                            ‚Ä¢ Can persist<br>
                                            ‚Ä¢ Priority levels<br>
                                            ‚Ä¢ Used in microservices
                                        </div>
                                    </div>
                                    
                                    <h4>üõ°Ô∏è Security Implications:</h4>
                                    <ul>
                                        <li><strong>Process Isolation:</strong> Foundation of system security. One compromised process shouldn't affect others.</li>
                                        <li><strong>Privilege Separation:</strong> Different components run as different users with minimal privileges.</li>
                                        <li><strong>Sandboxing:</strong> Running untrusted code in restricted processes.</li>
                                        <li><strong>Side-channel Attacks:</strong> Processes can infer information from shared resources (cache, memory bus).</li>
                                        <li><strong>IPC Security:</strong> Validating messages between processes to prevent injection.</li>
                                    </ul>
                                `,
                                whyItMatters: `
                                    <div class="callout callout-why">
                                        <h4>üõ°Ô∏è Why Understanding Processes and Threads Matters</h4>
                                        <p>This knowledge is crucial for:</p>
                                        <ul>
                                            <li><strong>Exploit Development:</strong> Understanding how to move between processes (process injection), manipulate shared memory</li>
                                            <li><strong>Malware Analysis:</strong> How malware creates persistence (process hollowing, DLL injection), spawns child processes</li>
                                            <li><strong>Privilege Escalation:</strong> Exploiting processes running with higher privileges</li>
                                            <li><strong>Forensics:</strong> Analyzing process trees, identifying suspicious parent-child relationships</li>
                                            <li><strong>Secure Programming:</strong> Writing thread-safe code, proper synchronization, avoiding race conditions</li>
                                            <li><strong>Performance Tuning:</strong> Understanding when to use threads vs processes, avoiding contention</li>
                                            <li><strong>Container Security:</strong> Modern containers are essentially isolated processes with extra constraints</li>
                                        </ul>
                                        <p><strong>Example:</strong> The "Dirty COW" vulnerability (CVE-2016-5195) was a race condition in the Linux kernel's memory subsystem that allowed privilege escalation. Understanding processes, memory mapping, and race conditions was essential to exploit it.</p>
                                        <p>Process/thread understanding separates those who can run exploits from those who can develop new ones or find novel attack vectors.</p>
                                    </div>
                                `,
                                misconceptions: `
                                    <div class="callout callout-misconception">
                                        <h4>‚ùå Common Misconceptions Debunked</h4>
                                        <p><strong>Myth:</strong> "More threads always means better performance."</p>
                                        <p><strong>Reality:</strong> Beyond the number of CPU cores, additional threads cause overhead from context switching and synchronization. I/O-bound tasks benefit from more threads; CPU-bound tasks benefit from thread count matching core count.</p>
                                        
                                        <p><strong>Myth:</strong> "Threads run in parallel on single-core CPUs."</p>
                                        <p><strong>Reality:</strong> On single-core systems, threads don't run simultaneously. The OS rapidly switches between them (timeslicing), creating the illusion of parallelism.</p>
                                        
                                        <p><strong>Myth:</strong> "Process isolation is absolute."</p>
                                        <p><strong>Reality:</strong> While processes have separate virtual address spaces, they share physical resources (CPU cache, memory bus, kernel data structures). Side-channel attacks like Spectre exploit these shared resources.</p>
                                        
                                        <p><strong>Myth:</strong> "Creating a thread is always cheaper than forking a process."</p>
                                        <p><strong>Reality:</strong> With copy-on-write fork() and modern OS optimizations, forking can be nearly as cheap as threading for some workloads, with better isolation benefits.</p>
                                        
                                        <p><strong>Security Impact:</strong> Believing process isolation is absolute leads to underestimating side-channel attacks. Believing threads are "free" leads to resource exhaustion attacks.</p>
                                    </div>
                                `,
                                examples: [
                                    {
                                        title: "Real-World Example: Web Browser Architecture",
                                        description: "Modern browsers use multiple processes for security: 1) Browser process (main UI), 2) Renderer processes (one per tab, isolated), 3) GPU process, 4) Network process, 5) Plugin processes. This architecture (called site isolation) prevents a compromised tab from affecting others or stealing data from other tabs."
                                    },
                                    {
                                        title: "Real-World Example: Database Connection Pool",
                                        description: "Database servers use thread pools to handle concurrent connections efficiently. Instead of creating a new process for each connection (expensive), they create a thread (cheap). However, they must carefully synchronize access to shared data structures like query caches and buffer pools."
                                    },
                                    {
                                        title: "Real-World Example: Containerized Applications",
                                        description: "Docker containers are not full virtual machines but isolated processes with their own filesystem, network, and process namespace. Understanding processes is key to container security - breaking out of a container means escaping process isolation boundaries."
                                    }
                                ],
                                exercises: [
                                    {
                                        level: "beginner",
                                        description: "Write a program that creates both a child process (using fork()) and a thread (using pthread_create or threading module). Have each print its PID and do some work. Use commands like 'ps', 'top', and 'pstree' to observe the process/thread hierarchy.",
                                        goal: "Hands-on experience creating processes and threads",
                                        expected: "Program demonstrating both process creation and thread creation with observation of system behavior"
                                    },
                                    {
                                        level: "intermediate",
                                        description: "Create a program with a race condition. Have multiple threads increment a shared counter without synchronization. Run it multiple times and observe inconsistent results. Then fix it using mutexes. Time both versions to see synchronization overhead.",
                                        goal: "Experience race conditions and thread synchronization",
                                        expected: "Two versions of program (with/without synchronization) demonstrating the problem and solution"
                                    },
                                    {
                                        level: "advanced",
                                        description: "Implement a simple IPC mechanism using shared memory. Create two processes: writer (produces data) and reader (consumes data). Implement proper synchronization using semaphores. Measure the throughput compared to other IPC methods (pipes, sockets).",
                                        goal: "Understand and implement inter-process communication",
                                        expected: "Complete IPC implementation with performance analysis"
                                    }
                                ],
                                mentalModels: `
                                    <div class="diagram">
                                        <div style="text-align: center; padding: 1rem;">
                                            <div style="border: 3px solid var(--accent-blue); padding: 1rem; margin: 0.5rem; display: inline-block;">
                                                <strong>Process: Office Building</strong><br>
                                                ‚Ä¢ Owns entire building<br>
                                                ‚Ä¢ Secure walls between offices<br>
                                                ‚Ä¢ Each has own utilities<br>
                                                ‚Ä¢ Moving between is expensive<br>
                                                ‚Ä¢ Fire in one doesn't spread
                                            </div>
                                            <div style="border: 3px solid var(--accent-green); padding: 1rem; margin: 0.5rem; display: inline-block;">
                                                <strong>Threads: Offices in Building</strong><br>
                                                ‚Ä¢ Share same building<br>
                                                ‚Ä¢ Thin walls between rooms<br>
                                                ‚Ä¢ Share utilities<br>
                                                ‚Ä¢ Easy to move between<br>
                                                ‚Ä¢ Fire can spread through building
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <p><strong>Mental Model 1: Apartment Complex</strong></p>
                                    <ul>
                                        <li><strong>Process = Apartment Unit:</strong> Has its own rooms, kitchen, bathroom. Can't directly access neighbor's apartment.</li>
                                        <li><strong>Threads = Roommates:</strong> Share the same apartment. Can access kitchen, living room. Must coordinate bathroom use.</li>
                                        <li><strong>IPC = Intercom/Mail:</strong> How apartments communicate with each other.</li>
                                        <li><strong>Kernel = Building Management:</strong> Controls shared resources (elevators, water), mediates disputes.</li>
                                    </ul>
                                    
                                    <p><strong>Mental Model 2: Restaurant Kitchen</strong></p>
                                    <ul>
                                        <li><strong>Process = Restaurant:</strong> Complete kitchen with all equipment. Separate from other restaurants.</li>
                                        <li><strong>Threads = Kitchen Staff:</strong> Chefs, sous-chefs, prep cooks sharing same kitchen.</li>
                                        <li><strong>Race Condition = Two cooks reaching for same ingredient:</strong> Need coordination.</li>
                                        <li><strong>Deadlock = Circular wait for resources:</strong> Chef A needs oven, Chef B needs cutting board, each has what the other needs.</li>
                                    </ul>
                                    
                                    <div class="callout callout-principle">
                                        <p><strong>First Principles Thinking:</strong> At the hardware level, there's only one CPU executing one instruction at a time (per core). Processes and threads are abstractions created by the operating system to manage multiple logical streams of execution. The OS achieves this by rapidly switching between tasks, saving and restoring CPU state (registers, program counter) for each switch. Memory isolation is achieved through virtual memory - each process thinks it has the entire address space, but the OS and CPU translate virtual addresses to different physical addresses.</p>
                                    </div>
                                `
                            }
                        },
                        {
                            id: "topic-0-4",
                            title: "Memory (stack vs heap - conceptual)",
                            completed: false,
                            content: {
                                explanation: `
                                    <h3>üèóÔ∏è Stack vs Heap Memory: Architecture and Security Implications</h3>
                                    <p>Understanding memory allocation strategies is fundamental to both programming and security exploitation. The stack and heap are two primary memory regions with different characteristics:</p>
                                    
                                    <div class="diagram">
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                                            <div style="border: 3px solid var(--accent-blue); padding: 1.5rem; border-radius: var(--radius-md);">
                                                <h4 style="color: var(--accent-blue); margin-top: 0;">üìö STACK MEMORY</h4>
                                                <p><strong>Purpose:</strong> Manage function calls and local variables</p>
                                                <ul>
                                                    <li><strong>Structure:</strong> Last-In-First-Out (LIFO)</li>
                                                    <li><strong>Allocation:</strong> Automatic (compiler-managed)</li>
                                                    <li><strong>Speed:</strong> Very fast (pointer adjustment)</li>
                                                    <li><strong>Size:</strong> Limited (typically 1-8 MB)</li>
                                                    <li><strong>Direction:</strong> Grows downward (higher to lower addresses)</li>
                                                    <li><strong>Fragmentation:</strong> None (strict ordering)</li>
                                                    <li><strong>Thread-specific:</strong> Each thread has its own stack</li>
                                                </ul>
                                            </div>
                                            <div style="border: 3px solid var(--accent-green); padding: 1.5rem; border-radius: var(--radius-md);">
                                                <h4 style="color: var(--accent-green); margin-top: 0;">üóÉÔ∏è HEAP MEMORY</h4>
                                                <p><strong>Purpose:</strong> Dynamic memory allocation at runtime</p>
                                                <ul>
                                                    <li><strong>Structure:</strong> Free-form (tree structures)</li>
                                                    <li><strong>Allocation:</strong> Manual (malloc/free, new/delete)</li>
                                                    <li><strong>Speed:</strong> Slower (search for free space)</li>
                                                    <li><strong>Size:</strong> Large (limited by system memory)</li>
                                                    <li><strong>Direction:</strong> Grows upward (lower to higher addresses)</li>
                                                    <li><strong>Fragmentation:</strong> Common (external/internal)</li>
                                                    <li><strong>Shared:</strong> Process-wide (accessible to all threads)</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <h4>üîç Stack Frame Anatomy:</h4>
                                    <p>When a function is called, a stack frame is created:</p>
                                    <div class="diagram">
                                        <div style="font-family: var(--monospace); background: var(--tertiary-bg); padding: 1rem; border-radius: var(--radius-md);">
                                            <strong>Higher Addresses</strong><br>
                                            ‚Üì Previous Stack Frame<br>
                                            ‚Üì ...<br>
                                            ‚Üì <strong>Current Function Stack Frame</strong><br>
                                            ‚îú‚îÄ‚îÄ Function Parameters<br>
                                            ‚îú‚îÄ‚îÄ Return Address (where to go back)<br>
                                            ‚îú‚îÄ‚îÄ Saved Base Pointer (previous frame)<br>
                                            ‚îú‚îÄ‚îÄ Local Variables<br>
                                            ‚îî‚îÄ‚îÄ Temporary Storage<br>
                                            ‚Üì Next Stack Frame<br>
                                            <strong>Lower Addresses</strong> (Stack grows this way)
                                        </div>
                                    </div>
                                    
                                    <h4>‚öôÔ∏è How Stack Works (Function Call Example):</h4>
                                    <div class="diagram data-flow-diagram">
                                        <div class="flow-node">1. Call function foo(10, 20)</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">2. Push parameters: 20, then 10</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">3. Push return address (after call)</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">4. Push saved base pointer</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">5. Allocate space for local variables</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">6. Execute function body</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">7. On return: Clean up, restore pointer</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">8. Jump to return address</div>
                                    </div>
                                    
                                    <h4>üèóÔ∏è Heap Allocation Strategies:</h4>
                                    <div class="trust-boundary">
                                        <div class="trust-zone high">
                                            <strong>First Fit</strong><br>
                                            ‚Ä¢ Use first block that's big enough<br>
                                            ‚Ä¢ Fast but causes fragmentation<br>
                                            ‚Ä¢ Simple to implement
                                        </div>
                                        <div class="trust-zone high">
                                            <strong>Best Fit</strong><br>
                                            ‚Ä¢ Use smallest block that's big enough<br>
                                            ‚Ä¢ Reduces waste but slower<br>
                                            ‚Ä¢ Can create small unusable fragments
                                        </div>
                                        <div class="trust-zone low">
                                            <strong>Worst Fit</strong><br>
                                            ‚Ä¢ Use largest available block<br>
                                            ‚Ä¢ Leaves large fragments for future<br>
                                            ‚Ä¢ Rarely used in practice
                                        </div>
                                        <div class="trust-zone high">
                                            <strong>Buddy System</strong><br>
                                            ‚Ä¢ Blocks in power-of-two sizes<br>
                                            ‚Ä¢ Easy coalescing of free blocks<br>
                                            ‚Ä¢ Used in Linux kernel
                                        </div>
                                    </div>
                                    
                                    <h4>üéØ Key Differences in Detail:</h4>
                                    <table>
                                        <thead>
                                            <tr>
                                                <th>Characteristic</th>
                                                <th>Stack</th>
                                                <th>Heap</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td><strong>Allocation/Deallocation</strong></td>
                                                <td>Automatic (push/pop)</td>
                                                <td>Manual (malloc/free)</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Access Speed</strong></td>
                                                <td>Very fast (pointer arithmetic)</td>
                                                <td>Slower (indirect, possible search)</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Memory Management</strong></td>
                                                <td>Compiler/CPU (frame pointers)</td>
                                                <td>Programmer (manual) or GC</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Size Limits</strong></td>
                                                <td>Small, fixed at thread creation</td>
                                                <td>Large, up to available RAM</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Fragmentation</strong></td>
                                                <td>None (LIFO guarantees order)</td>
                                                <td>External and internal</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Thread Safety</strong></td>
                                                <td>Inherent (per-thread stacks)</td>
                                                <td>Requires synchronization</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Common Errors</strong></td>
                                                <td>Stack overflow, buffer overrun</td>
                                                <td>Memory leaks, dangling pointers</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Security Risks</strong></td>
                                                <td>Return address overwrite</td>
                                                <td>Use-after-free, heap spraying</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    
                                    <div class="callout callout-example">
                                        <h4>üîç Real-World Security Scenario: Buffer Overflow</h4>
                                        <p><strong>Stack-based Buffer Overflow:</strong></p>
                                        <pre><code>void vulnerable(char *input) {
    char buffer[64];  // On stack
    strcpy(buffer, input);  // No bounds check!
    // Return address is right after buffer on stack
}</code></pre>
                                        <p><strong>Attack:</strong> Input longer than 64 bytes overwrites return address. Attacker sets it to point to their shellcode (also in buffer).</p>
                                        <p><strong>Result:</strong> When function returns, it jumps to attacker's code instead of legitimate return address.</p>
                                        <p><strong>Defenses:</strong> Stack canaries (guard values), NX bit (make stack non-executable), ASLR (randomize addresses).</p>
                                        
                                        <p><strong>Heap-based Buffer Overflow:</strong></p>
                                        <pre><code>char *buffer = malloc(64);  // On heap
strcpy(buffer, oversized_input);  // Overflow into adjacent heap metadata</code></pre>
                                        <p><strong>Attack:</strong> Overwrite heap metadata (size, next pointer) to gain arbitrary write primitive.</p>
                                        <p><strong>Result:</strong> Can overwrite function pointers, modify data structures.</p>
                                        <p><strong>Defenses:</strong> Heap hardening (metadata encryption, guard pages), allocator security features.</p>
                                    </div>
                                    
                                    <h4>üõ°Ô∏è Security Implications of Memory Management:</h4>
                                    <ul>
                                        <li><strong>Stack Overflows:</strong> Classic attack vector. Overwrite return address to control execution flow.</li>
                                        <li><strong>Heap Overflows:</strong> More complex but powerful. Corrupt heap metadata or adjacent objects.</li>
                                        <li><strong>Use-After-Free:</strong> Access memory after it's freed. Can lead to type confusion or code execution.</li>
                                        <li><strong>Double Free:</strong> Freeing memory twice. Can corrupt heap metadata.</li>
                                        <li><strong>Uninitialized Memory:</strong> Reading memory before writing to it. Can leak sensitive data.</li>
                                        <li><strong>Memory Disclosure:</strong> Reading outside bounds. Can leak addresses (defeating ASLR) or sensitive data.</li>
                                    </ul>
                                    
                                    <h4>üîß Modern Memory Protections:</h4>
                                    <div class="trust-boundary">
                                        <div class="trust-zone high">
                                            <strong>ASLR (Address Space Layout Randomization)</strong><br>
                                            ‚Ä¢ Randomizes memory addresses<br>
                                            ‚Ä¢ Makes predicting addresses hard<br>
                                            ‚Ä¢ Defeats many code injection attacks<br>
                                            ‚Ä¢ Can be bypassed with info leaks
                                        </div>
                                        <div class="trust-zone high">
                                            <strong>DEP/NX (Data Execution Prevention)</strong><br>
                                            ‚Ä¢ Marks data memory as non-executable<br>
                                            ‚Ä¢ Prevents code execution from stack/heap<br>
                                            ‚Ä¢ Hardware support (NX bit in CPUs)<br>
                                            ‚Ä¢ Bypassed with ROP (return-oriented programming)
                                        </div>
                                        <div class="trust-zone low">
                                            <strong>Stack Canaries</strong><br>
                                            ‚Ä¢ Guard value before return address<br>
                                            ‚Ä¢ Checked before function return<br>
                                            ‚Ä¢ Crash on corruption detection<br>
                                            ‚Ä¢ Can be leaked or brute-forced
                                        </div>
                                        <div class="trust-zone high">
                                            <strong>Control Flow Integrity</strong><br>
                                            ‚Ä¢ Verifies indirect calls/jumps<br>
                                            ‚Ä¢ Ensures control flow follows valid paths<br>
                                            ‚Ä¢ Advanced protection technique<br>
                                            ‚Ä¢ Performance overhead
                                        </div>
                                    </div>
                                `,
                                whyItMatters: `
                                    <div class="callout callout-why">
                                        <h4>üõ°Ô∏è Why Understanding Stack vs Heap Matters</h4>
                                        <p>This knowledge is essential for:</p>
                                        <ul>
                                            <li><strong>Exploit Development:</strong> Crafting buffer overflows, return-oriented programming (ROP) chains, heap spraying attacks</li>
                                            <li><strong>Vulnerability Research:</strong> Finding and analyzing memory corruption bugs in software</li>
                                            <li><strong>Reverse Engineering:</strong> Understanding disassembled code, recognizing stack/heap usage patterns</li>
                                            <li><strong>Secure Coding:</strong> Writing memory-safe code, choosing appropriate allocation strategies</li>
                                            <li><strong>Malware Analysis:</strong> Understanding how exploits work, analyzing shellcode</li>
                                            <li><strong>Forensics:</strong> Analyzing memory dumps, understanding attack artifacts</li>
                                            <li><strong>System Hardening:</strong> Configuring memory protections appropriately</li>
                                        </ul>
                                        <p><strong>Example:</strong> The "Heartbleed" vulnerability (CVE-2014-0160) was a buffer over-read in OpenSSL. It allowed reading heap memory beyond allocated bounds, leaking private keys and other sensitive data. Understanding heap memory layout was key to both exploiting and understanding this vulnerability.</p>
                                        <p>Memory corruption vulnerabilities represent a large percentage of critical security issues. Understanding stack vs heap is foundational to working with these vulnerabilities.</p>
                                    </div>
                                `,
                                misconceptions: `
                                    <div class="callout callout-misconception">
                                        <h4>‚ùå Common Misconceptions Debunked</h4>
                                        <p><strong>Myth:</strong> "Stack is faster than heap because it's in CPU cache."</p>
                                        <p><strong>Reality:</strong> Both stack and heap use the same RAM and CPU cache. Stack is faster because allocation is simple pointer adjustment, while heap allocation requires searching free lists and managing metadata.</p>
                                        
                                        <p><strong>Myth:</strong> "Objects are always on the heap in object-oriented languages."</p>
                                        <p><strong>Reality:</strong> In C++, objects can be on stack (local variables) or heap (via new). In Java, primitive types and object references can be on stack, but objects themselves are always on heap. In C#, structs are value types (can be stack), classes are reference types (heap).</p>
                                        
                                        <p><strong>Myth:</strong> "Stack memory is automatically freed when function returns."</p>
                                        <p><strong>Reality:</strong> The memory isn't "freed" in the sense of being made unavailable. The stack pointer is simply moved, making that memory available for reuse by subsequent function calls. The old data remains until overwritten.</p>
                                        
                                        <p><strong>Myth:</strong> "Heap fragmentation is always bad."</p>
                                        <p><strong>Reality:</strong> Some fragmentation is inevitable with dynamic allocation. The goal is to manage it, not eliminate it completely. Different allocators make different tradeoffs between fragmentation, speed, and memory overhead.</p>
                                        
                                        <p><strong>Security Myth:</strong> "Stack overflows are dead due to modern protections."</p>
                                        <p><strong>Reality:</strong> While basic stack overflows are harder due to stack canaries and ASLR, they still occur and can be exploited, especially in embedded systems or with specific bypass techniques.</p>
                                    </div>
                                `,
                                examples: [
                                    {
                                        title: "Real-World Example: Web Server Memory Management",
                                        description: "Apache/Nginx web servers handle thousands of concurrent connections. Each connection needs memory for buffers, state, etc. Using stack for per-connection data would quickly exhaust stack space. Using heap allows dynamic allocation. However, they must carefully manage heap memory to avoid fragmentation and leaks under heavy load."
                                    },
                                    {
                                        title: "Real-World Example: JavaScript Engine Memory",
                                        description: "V8 (Chrome's JavaScript engine) uses a complex memory system: 1) Stack for primitive values and references, 2) Heap for objects and strings, divided into New Space (young objects) and Old Space (surviving objects), 3) Large Object Space for big allocations. Understanding this helps in optimizing JavaScript performance and understanding certain exploitation techniques."
                                    },
                                    {
                                        title: "Real-World Example: Mobile App Security",
                                        description: "iOS and Android apps have limited stack space per thread (typically 1MB). Deep recursion or large stack allocations can cause crashes. Heap space is larger but shared. Memory management errors in mobile apps can lead to crashes (annoying) or, in worst cases, information disclosure vulnerabilities if sensitive data isn't properly cleared from memory."
                                    }
                                ],
                                exercises: [
                                    {
                                        level: "beginner",
                                        description: "Write a C program that demonstrates stack and heap allocation. Create: 1) Local variables (stack), 2) malloc'd memory (heap). Print their addresses. Observe the direction (stack addresses decreasing, heap increasing). Create a recursive function that causes stack overflow.",
                                        goal: "Visualize stack and heap memory layout",
                                        expected: "Program showing address patterns and demonstrating stack overflow"
                                    },
                                    {
                                        level: "intermediate",
                                        description: "Write a vulnerable program with a stack buffer overflow. Create a function with a fixed-size buffer and unsafe copy. Craft input that overwrites the return address (you can use a debugger to find the offset). Then implement protections: 1) Stack canary, 2) Safe string functions. Test that the exploit no longer works.",
                                        goal: "Hands-on experience with buffer overflow and protection mechanisms",
                                        expected: "Vulnerable program, exploit, and protected version"
                                    },
                                    {
                                        level: "advanced",
                                        description: "Implement a simple heap allocator. Support malloc() and free(). Handle fragmentation with coalescing. Add security features: 1) Canaries around allocations, 2) Free list integrity checks, 3) Use-after-free detection. Test it with various allocation patterns and attempt to exploit a vulnerable program using your allocator vs standard malloc.",
                                        goal: "Deep understanding of heap internals and security features",
                                        expected: "Custom heap allocator implementation with security features"
                                    }
                                ],
                                mentalModels: `
                                    <div class="diagram">
                                        <div style="text-align: center; padding: 1rem;">
                                            <div style="border: 3px solid var(--accent-blue); padding: 1rem; margin: 0.5rem; display: inline-block; width: 45%;">
                                                <strong>Stack: Stack of Plates</strong><br>
                                                ‚Ä¢ Add/remove from top only<br>
                                                ‚Ä¢ Fixed order (LIFO)<br>
                                                ‚Ä¢ Know exact position of each plate<br>
                                                ‚Ä¢ Can't remove middle plate without removing top ones<br>
                                                ‚Ä¢ Limited height before collapse
                                            </div>
                                            <div style="border: 3px solid var(--accent-green); padding: 1rem; margin: 0.5rem; display: inline-block; width: 45%;">
                                                <strong>Heap: Toy Box</strong><br>
                                                ‚Ä¢ Can put in/take out anywhere<br>
                                                ‚Ä¢ No fixed order<br>
                                                ‚Ä¢ Need to search for specific toy<br>
                                                ‚Ä¢ Can become messy (fragmentation)<br>
                                                ‚Ä¢ Large capacity but harder to manage
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <p><strong>Mental Model 1: Office Desk vs Filing Cabinet</strong></p>
                                    <ul>
                                        <li><strong>Stack = Desk Surface:</strong> Only so much space. Current work on top. When done, clear it for next task. Fast to access what's on top.</li>
                                        <li><strong>Heap = Filing Cabinet:</strong> Lots of space. Can store many things. Need to organize and remember where things are. Slower to retrieve.</li>
                                        <li><strong>Stack Overflow = Desk Too Full:</strong> Papers spilling onto floor.</li>
                                        <li><strong>Heap Fragmentation = Messy Cabinet:</strong> Small gaps everywhere, hard to fit new folders.</li>
                                    </ul>
                                    
                                    <p><strong>Mental Model 2: Restaurant Kitchen Workflow</strong></p>
                                    <ul>
                                        <li><strong>Stack = Prep Station:</strong> Limited space. Ingredients for current dish. When dish done, clear station for next.</li>
                                        <li><strong>Heap = Walk-in Cooler:</strong> All ingredients available. Can take what you need, when you need it.</li>
                                        <li><strong>Stack Frame = Recipe Steps:</strong> Each step uses prep station, then clears it.</li>
                                        <li><strong>Heap Allocation = Special Order:</strong> Need uncommon ingredient from cooler.</li>
                                        <li><strong>Memory Leak = Forgotten Ingredients:</strong> Left in cooler until they spoil (wasted space).</li>
                                    </ul>
                                    
                                    <div class="callout callout-principle">
                                        <p><strong>First Principles Thinking:</strong> At the hardware level, there's no distinction between stack and heap - it's all just memory addresses. The stack is a convention where the program uses a register (stack pointer) to track a region of memory used in LIFO order. The heap is everything else. The CPU provides instructions like PUSH/POP for stack manipulation, but heap management is entirely software. Memory protection (read/write/execute permissions) applies equally to all memory regions. The security issues arise from how programs use these regions, not from the regions themselves.</p>
                                    </div>
                                `
                            }
                        },
                        {
                            id: "topic-0-5",
                            title: "Filesystems",
                            completed: false,
                            content: {
                                explanation: `
                                    <h3>üìÅ Filesystems: Data Organization and Security</h3>
                                    <p>Filesystems provide the structure for organizing and accessing data on storage devices. Understanding filesystems is crucial for both system administration and security analysis:</p>
                                    
                                    <div class="diagram">
                                        <div style="text-align: center; padding: 1rem;">
                                            <div style="border: 2px solid var(--accent-blue); padding: 0.5rem; margin: 0.5rem; display: inline-block;">
                                                <strong>Physical Storage</strong><br>
                                                Blocks/Sectors
                                            </div>
                                            <div style="margin: 1rem;">‚Üì Filesystem Abstraction ‚Üì</div>
                                            <div style="border: 2px solid var(--accent-green); padding: 0.5rem; margin: 0.5rem; display: inline-block;">
                                                <strong>Logical View</strong><br>
                                                Files & Directories
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <h4>üìä Common Filesystem Types:</h4>
                                    <div class="trust-boundary">
                                        <div class="trust-zone high">
                                            <strong>Windows: NTFS</strong><br>
                                            ‚Ä¢ Journaling (crash recovery)<br>
                                            ‚Ä¢ Access Control Lists (ACLs)<br>
                                            ‚Ä¢ Encryption (EFS)<br>
                                            ‚Ä¢ Compression, quotas<br>
                                            ‚Ä¢ Master File Table (MFT)
                                        </div>
                                        <div class="trust-zone high">
                                            <strong>Linux: ext4</strong><br>
                                            ‚Ä¢ Default for most Linux<br>
                                            ‚Ä¢ Journaling (metadata+data)<br>
                                            ‚Ä¢ Extended attributes<br>
                                            ‚Ä¢ 1EB max file size<br>
                                            ‚Ä¢ Delayed allocation
                                        </div>
                                        <div class="trust-zone low">
                                            <strong>macOS: APFS</strong><br>
                                            ‚Ä¢ Apple File System<br>
                                            ‚Ä¢ Copy-on-write<br>
                                            ‚Ä¢ Space sharing (containers)<br>
                                            ‚Ä¢ Native encryption<br>
                                            ‚Ä¢ Snapshots
                                        </div>
                                        <div class="trust-zone high">
                                            <strong>Network: NFS/SMB</strong><br>
                                            ‚Ä¢ Remote file access<br>
                                            ‚Ä¢ Client-server model<br>
                                            ‚Ä¢ Permission mapping<br>
                                            ‚Ä¢ Caching for performance
                                        </div>
                                    </div>
                                    
                                    <h4>üèóÔ∏è Filesystem Components:</h4>
                                    <div class="diagram">
                                        <div style="font-family: var(--monospace); background: var(--tertiary-bg); padding: 1rem; border-radius: var(--radius-md);">
                                            <strong>Filesystem Architecture Layers:</strong><br>
                                            1. <strong>Physical Layer:</strong> Blocks/Sectors on disk<br>
                                            2. <strong>Allocation Layer:</strong> Tracks free/used blocks (bitmap, B-tree)<br>
                                            3. <strong>Metadata Layer:</strong> Inodes/directories (file info)<br>
                                            4. <strong>Naming Layer:</strong> Path resolution (/home/user/file.txt)<br>
                                            5. <strong>API Layer:</strong> System calls (open, read, write, close)
                                        </div>
                                    </div>
                                    
                                    <h4>üîç Inode Structure (Unix/Linux):</h4>
                                    <p>Inodes store metadata about files (not the filename!):</p>
                                    <div class="diagram">
                                        <div style="font-family: var(--monospace); background: var(--tertiary-bg); padding: 1rem; border-radius: var(--radius-md);">
                                            <strong>Inode 2567 (example.txt)</strong><br>
                                            ‚îú‚îÄ‚îÄ File type & permissions (rw-r--r--)<br>
                                            ‚îú‚îÄ‚îÄ Owner UID/GID (1000/1000)<br>
                                            ‚îú‚îÄ‚îÄ Size in bytes (4096)<br>
                                            ‚îú‚îÄ‚îÄ Timestamps:<br>
                                            ‚îÇ   ‚îú‚îÄ‚îÄ Access (atime)<br>
                                            ‚îÇ   ‚îú‚îÄ‚îÄ Modify (mtime)<br>
                                            ‚îÇ   ‚îî‚îÄ‚îÄ Change (ctime)<br>
                                            ‚îú‚îÄ‚îÄ Link count (1)<br>
                                            ‚îú‚îÄ‚îÄ Block pointers (direct, indirect)<br>
                                            ‚îî‚îÄ‚îÄ Extended attributes
                                        </div>
                                    </div>
                                    
                                    <h4>üìÅ Directory Structure and Path Resolution:</h4>
                                    <div class="diagram data-flow-diagram">
                                        <div class="flow-node">Path: /home/user/docs/file.txt</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">1. Start at root directory (/)</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">2. Find 'home' entry ‚Üí inode</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">3. Read 'home' directory contents</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">4. Find 'user' entry ‚Üí inode</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">5. Read 'user' directory contents</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">6. Find 'docs' entry ‚Üí inode</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">7. Read 'docs' directory contents</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">8. Find 'file.txt' entry ‚Üí inode</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">9. Access file data via inode</div>
                                    </div>
                                    
                                    <h4>‚öôÔ∏è How Files Are Stored:</h4>
                                    <div class="diagram">
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                                            <div style="border: 2px solid var(--accent-blue); padding: 1rem; border-radius: var(--radius-md);">
                                                <strong>Small Files</strong><br>
                                                ‚Ä¢ Data stored directly in inode<br>
                                                ‚Ä¢ "Inline data" or "tail packing"<br>
                                                ‚Ä¢ Faster access (no extra blocks)<br>
                                                ‚Ä¢ Limited size (~Âá†Áôæ bytes)
                                            </div>
                                            <div style="border: 2px solid var(--accent-green); padding: 1rem; border-radius: var(--radius-md);">
                                                <strong>Large Files</strong><br>
                                                ‚Ä¢ Data in separate data blocks<br>
                                                ‚Ä¢ Inode has block pointers<br>
                                                ‚Ä¢ Direct blocks (first few)<br>
                                                ‚Ä¢ Indirect blocks (for large files)<br>
                                                ‚Ä¢ Double/triple indirect (huge files)
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <h4>üéØ Key Filesystem Concepts:</h4>
                                    <table>
                                        <thead>
                                            <tr>
                                                <th>Concept</th>
                                                <th>Description</th>
                                                <th>Security Implication</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td><strong>Journaling</strong></td>
                                                <td>Log changes before committing</td>
                                                <td>Prevents corruption but log may contain sensitive data</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Hard Links</strong></td>
                                                <td>Multiple directory entries point to same inode</td>
                                                <td>Can hide files (unlink doesn't delete if other links exist)</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Soft Links</strong></td>
                                                <td>Symbolic links - special file containing path</td>
                                                <td>Can point anywhere, including across filesystems</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Extended Attributes</strong></td>
                                                <td>Extra metadata (SELinux, capabilities)</td>
                                                <td>Used for security labeling, immutable flags</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Mount Points</strong></td>
                                                <td>Where filesystem attaches to directory tree</td>
                                                <td>Can hide/unhide parts of filesystem</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Quotas</strong></td>
                                                <td>Limit user/group disk usage</td>
                                                <td>Prevents denial of service via disk filling</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    
                                    <div class="callout callout-example">
                                        <h4>üîç Real-World Security Scenario: Path Traversal</h4>
                                        <p><strong>Vulnerability:</strong> Web application uses user input to construct file paths without validation:</p>
                                        <pre><code>String filename = request.getParameter("file");
File file = new File("/var/www/uploads/" + filename);
// Attacker sends: "../../../etc/passwd"</code></pre>
                                        <p><strong>Result:</strong> Accesses /etc/passwd instead of intended file.</p>
                                        <p><strong>Defenses:</strong> Path canonicalization, whitelist allowed files, chroot/jail.</p>
                                        
                                        <p><strong>Scenario: Symlink Attacks</strong></p>
                                        <pre><code>// Program creates temp file
String tempPath = "/tmp/app_" + getpid();
// Attacker creates symlink: /tmp/app_1234 ‚Üí /etc/passwd
// Program writes to "temp file", overwrites /etc/passwd</code></pre>
                                        <p><strong>Defenses:</strong> Use secure temp file creation (O_EXCL flag), random names, dedicated temp directories.</p>
                                    </div>
                                    
                                    <h4>üõ°Ô∏è Filesystem Security Features:</h4>
                                    <div class="trust-boundary">
                                        <div class="trust-zone high">
                                            <strong>Access Control Lists</strong><br>
                                            ‚Ä¢ Fine-grained permissions<br>
                                            ‚Ä¢ Multiple users/groups per file<br>
                                            ‚Ä¢ Allow/deny specific permissions<br>
                                            ‚Ä¢ Windows: DACLs, SACLs<br>
                                            ‚Ä¢ Linux: POSIX ACLs
                                        </div>
                                        <div class="trust-zone high">
                                            <strong>File Attributes</strong><br>
                                            ‚Ä¢ Immutable (cannot be modified)<br>
                                            ‚Ä¢ Append-only (can only add)<br>
                                            ‚Ä¢ No-dump (exclude from backups)<br>
                                            ‚Ä¢ Linux: chattr +i file<br>
                                            ‚Ä¢ Windows: readonly, hidden
                                        </div>
                                        <div class="trust-zone low">
                                            <strong>Encryption</strong><br>
                                            ‚Ä¢ Full-disk encryption<br>
                                            ‚Ä¢ File-level encryption<br>
                                            ‚Ä¢ Windows: BitLocker, EFS<br>
                                            ‚Ä¢ Linux: LUKS, eCryptfs<br>
                                            ‚Ä¢ macOS: FileVault
                                        </div>
                                        <div class="trust-zone high">
                                            <strong>Auditing</strong><br>
                                            ‚Ä¢ Log file access attempts<br>
                                            ‚Ä¢ Windows: SACL auditing<br>
                                            ‚Ä¢ Linux: auditd<br>
                                            ‚Ä¢ Can track who accessed what<br>
                                            ‚Ä¢ Performance impact
                                        </div>
                                    </div>
                                    
                                    <h4>üîé Forensic Considerations:</h4>
                                    <ul>
                                        <li><strong>Deleted Files:</strong> Only metadata removed; data remains until overwritten</li>
                                        <li><strong>Slack Space:</strong> Unused portion of last block can contain old data</li>
                                        <li><strong>Timestamps:</strong> atime/mtime/ctime can reveal activity timeline</li>
                                        <li><strong>Journal:</strong> May contain records of deleted/modified files</li>
                                        <li><strong>Extended Attributes:</strong> Can contain malware or hidden data</li>
                                        <li><strong>Alternate Data Streams (NTFS):</strong> Hidden data attached to files</li>
                                    </ul>
                                    
                                    <h4>‚ö†Ô∏è Common Filesystem Attacks:</h4>
                                    <ol>
                                        <li><strong>Path Traversal:</strong> Using ../ to access unauthorized directories</li>
                                        <li><strong>Symlink Attacks:</strong> Tricking programs into following malicious symlinks</li>
                                        <li><strong>TOCTTOU:</strong> Time-of-check-to-time-of-use race conditions</li>
                                        <li><strong>Directory Climbing:</strong> Using relative paths to escape chroot/jails</li>
                                        <li><strong>Disk Exhaustion:</strong> Filling disk to cause denial of service</li>
                                        <li><strong>Metadata Corruption:</strong> Manipulating inodes/directories to hide files</li>
                                    </ol>
                                `,
                                whyItMatters: `
                                    <div class="callout callout-why">
                                        <h4>üõ°Ô∏è Why Understanding Filesystems Matters</h4>
                                        <p>Filesystem knowledge is essential for:</p>
                                        <ul>
                                            <li><strong>Web Application Security:</strong> Path traversal, file upload vulnerabilities, local file inclusion</li>
                                            <li><strong>Privilege Escalation:</strong> Exploiting misconfigured permissions, SUID binaries, writable system directories</li>
                                            <li><strong>Forensics:</strong> Recovering deleted files, analyzing file metadata, timeline analysis</li>
                                            <li><strong>Malware Analysis:</strong> Understanding persistence mechanisms (startup files, cron jobs, services)</li>
                                            <li><strong>Secure Configuration:</strong> Setting appropriate permissions, implementing least privilege</li>
                                            <li><strong>Data Protection:</strong> Implementing encryption, access controls, backup strategies</li>
                                            <li><strong>Incident Response:</strong> Identifying compromised files, understanding attack vectors</li>
                                        </ul>
                                        <p><strong>Example:</strong> The "EternalBlue" exploit (MS17-010) targeted SMB filesharing protocol. Understanding how SMB works (including filesystem semantics over network) was key to both exploiting and defending against this attack.</p>
                                        <p>Filesystem vulnerabilities are among the most common in web applications. Understanding filesystem internals helps you find these vulnerabilities and understand their impact.</p>
                                    </div>
                                `,
                                misconceptions: `
                                    <div class="callout callout-misconception">
                                        <h4>‚ùå Common Misconceptions Debunked</h4>
                                        <p><strong>Myth:</strong> "When I delete a file, the data is immediately gone."</p>
                                        <p><strong>Reality:</strong> Most filesystems only remove the directory entry. The data blocks remain allocated until overwritten. Secure deletion requires overwriting multiple times.</p>
                                        
                                        <p><strong>Myth:</strong> "Filenames are stored with the file data."</p>
                                        <p><strong>Reality:</strong> Filenames are stored in directory entries, which point to inodes. Inodes contain metadata and data block pointers. Multiple filenames (hard links) can point to the same inode.</p>
                                        
                                        <p><strong>Myth:</strong> "Emptying trash/recycle bin securely deletes files."</p>
                                        <p><strong>Reality:</strong> It typically just deletes the files from the trash directory. The data remains on disk unless the filesystem overwrites it.</p>
                                        
                                        <p><strong>Myth:</strong> "Formatting a disk erases all data."</p>
                                        <p><strong>Reality:</strong> Quick format only recreates filesystem structures. Full format may overwrite some areas but not necessarily all data. Physical destruction or multiple overwrites is needed for true erasure.</p>
                                        
                                        <p><strong>Myth:</strong> "File permissions (rwx) are absolute security."</p>
                                        <p><strong>Reality:</strong> Root/admin can bypass most permissions. Physical access to disk allows reading raw data. Encrypted filesystems provide better protection.</p>
                                        
                                        <p><strong>Security Impact:</strong> These misconceptions lead to false sense of security regarding data deletion and privacy.</p>
                                    </div>
                                `,
                                examples: [
                                    {
                                        title: "Real-World Example: Web Server File Permissions",
                                        description: "Apache/Nginx web servers typically run as user 'www-data' or 'apache'. Web root files need read permission for this user. Upload directories need write permission but NOT execute permission (to prevent uploading PHP shells). Configuration files should be readable only by root. Understanding these permission requirements is essential for secure web server configuration."
                                    },
                                    {
                                        title: "Real-World Example: Database Security",
                                        description: "Database files (like MySQL .ibd files or PostgreSQL data directory) contain sensitive information. They should have strict permissions (readable only by database process). Backups should be encrypted. Understanding filesystem permissions helps prevent unauthorized access to database files, which could bypass database authentication entirely."
                                    },
                                    {
                                        title: "Real-World Example: Container Filesystem Isolation",
                                        description: "Docker containers use layered filesystems (UnionFS). Each layer is read-only except the top writable layer. Understanding this helps with: 1) Security (immutable base layers), 2) Performance (layer caching), 3) Forensics (analyzing container filesystem changes). Breaking out of container filesystem isolation is a common privilege escalation vector."
                                    }
                                ],
                                exercises: [
                                    {
                                        level: "beginner",
                                        description: "Explore your system's filesystem hierarchy. Document the purpose of key directories: /, /bin, /etc, /home, /var, /tmp, /proc. Check permissions on each. Find files with special permissions (SUID bit). Use commands: ls -la, find, stat.",
                                        goal: "Understand Linux/Unix filesystem structure and permissions",
                                        expected: "Documentation of filesystem hierarchy with analysis of key directories"
                                    },
                                    {
                                        level: "intermediate",
                                        description: "Create a vulnerable web application with file upload functionality. Implement common mistakes: 1) No file type validation, 2) Using original filename, 3) Storing in web-accessible directory. Then exploit it: upload PHP shell, traverse directories, etc. Finally, fix all vulnerabilities.",
                                        goal: "Hands-on experience with file upload vulnerabilities",
                                        expected: "Vulnerable application, exploitation demonstration, and secure version"
                                    },
                                    {
                                        level: "advanced",
                                        description: "Perform filesystem forensics on a disk image. Use tools like sleuthkit/autopsy to: 1) Recover deleted files, 2) Analyze file metadata/timestamps, 3) Search for hidden data (alternate data streams, slack space), 4) Create timeline of file activity. Document your findings.",
                                        goal: "Learn filesystem forensics techniques",
                                        expected: "Forensic analysis report of disk image with recovered artifacts"
                                    }
                                ],
                                mentalModels: `
                                    <div class="diagram">
                                        <div style="text-align: center; padding: 1rem;">
                                            <div style="border: 2px solid var(--accent-blue); padding: 1rem; margin: 0.5rem; display: inline-block; width: 45%;">
                                                <strong>Library Catalog System</strong><br>
                                                ‚Ä¢ Card catalog = Directory structure<br>
                                                ‚Ä¢ Book record = Inode (metadata)<br>
                                                ‚Ä¢ Book location = Data blocks<br>
                                                ‚Ä¢ Multiple cards for same book = Hard links<br>
                                                ‚Ä¢ Reference to other catalog = Symlink
                                            </div>
                                            <div style="border: 2px solid var(--accent-green); padding: 1rem; margin: 0.5rem; display: inline-block; width: 45%;">
                                                <strong>Office Filing System</strong><br>
                                                ‚Ä¢ File cabinet = Disk partition<br>
                                                ‚Ä¢ Drawers = Directories<br>
                                                ‚Ä¢ Folder tabs = Directory entries<br>
                                                ‚Ä¢ Folder contents = File data<br>
                                                ‚Ä¢ Index cards = Inode metadata
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <p><strong>Mental Model 1: Library Analogy</strong></p>
                                    <ul>
                                        <li><strong>Bookshelves = Disk blocks:</strong> Physical storage locations</li>
                                        <li><strong>Book = File data:</strong> Actual content</li>
                                        <li><strong>Catalog card = Directory entry:</strong> Points to book location</li>
                                        <li><strong>Card catalog = Directory structure:</strong> Organized index</li>
                                        <li><strong>Multiple cards for same book = Hard links:</strong> Different ways to find same book</li>
                                        <li><strong>"See also" card = Symbolic link:</strong> Reference to another card</li>
                                        <li><strong>Checkout record = Open file handle:</strong> Tracking who's using book</li>
                                    </ul>
                                    
                                    <p><strong>Mental Model 2: Warehouse Management</strong></p>
                                    <ul>
                                        <li><strong>Warehouse = Disk:</strong> Physical storage space</li>
                                        <li><strong>Storage bins = Blocks:</strong> Fixed-size containers</li>
                                        <li><strong>Inventory system = Filesystem:</strong> Tracks what's where</li>
                                        <li><strong>SKU numbers = Inode numbers:</strong> Unique identifiers</li>
                                        <li><strong>Product descriptions = Metadata:</strong> Size, type, etc.</li>
                                        <li><strong>Location codes = Block pointers:</strong> Where to find items</li>
                                        <li><strong>Picking list = Path resolution:</strong> How to get to item</li>
                                    </ul>
                                    
                                    <div class="callout callout-principle">
                                        <p><strong>First Principles Thinking:</strong> At the physical level, storage devices are just arrays of blocks that can store bits. Filesystems create abstraction layers on top: 1) Organize blocks into files, 2) Track free/used blocks, 3) Provide naming and hierarchy, 4) Add metadata and permissions. All filesystem operations ultimately translate to read/write operations on specific block addresses. Security is about controlling which blocks can be read/written by whom, and ensuring the mapping between names and blocks can't be subverted.</p>
                                    </div>
                                `
                            }
                        },
                        {
                            id: "topic-0-6",
                            title: "Permissions and users",
                            completed: false,
                            content: {
                                explanation: `
                                    <h3>üë§ Users, Groups, and Permissions: Access Control Fundamentals</h3>
                                    <p>Understanding how operating systems control access to resources is fundamental to both system administration and security. This involves users, groups, and permission systems:</p>
                                    
                                    <div class="diagram">
                                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem;">
                                            <div style="border: 3px solid var(--accent-blue); padding: 1rem; border-radius: var(--radius-md); text-align: center;">
                                                <h4 style="color: var(--accent-blue); margin-top: 0;">üë§ USERS</h4>
                                                <p>Individual accounts</p>
                                                <ul style="text-align: left;">
                                                    <li>Unique UID (User ID)</li>
                                                    <li>Home directory</li>
                                                    <li>Default shell</li>
                                                    <li>Primary group</li>
                                                </ul>
                                            </div>
                                            <div style="border: 3px solid var(--accent-green); padding: 1rem; border-radius: var(--radius-md); text-align: center;">
                                                <h4 style="color: var(--accent-green); margin-top: 0;">üë• GROUPS</h4>
                                                <p>Collections of users</p>
                                                <ul style="text-align: left;">
                                                    <li>Unique GID (Group ID)</li>
                                                    <li>Users can belong to multiple</li>
                                                    <li>Simplifies permission management</li>
                                                    <li>Primary vs secondary groups</li>
                                                </ul>
                                            </div>
                                            <div style="border: 3px solid var(--accent-amber); padding: 1rem; border-radius: var(--radius-md); text-align: center;">
                                                <h4 style="color: var(--accent-amber); margin-top: 0;">üîê PERMISSIONS</h4>
                                                <p>Access control rules</p>
                                                <ul style="text-align: left;">
                                                    <li>Read (r), Write (w), Execute (x)</li>
                                                    <li>Owner, Group, Others</li>
                                                    <li>Special bits (SUID, SGID)</li>
                                                    <li>Extended attributes</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <h4>üìã User Account Database Files (Linux/Unix):</h4>
                                    <div class="diagram">
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                                            <div style="border: 2px solid var(--accent-blue); padding: 1rem; border-radius: var(--radius-md);">
                                                <strong>/etc/passwd</strong><br>
                                                <em>World-readable user information</em><br>
                                                Format: username:password:UID:GID:GECOS:homedir:shell<br><br>
                                                Example:<br>
                                                <code>alice:x:1000:1000:Alice User:/home/alice:/bin/bash</code><br><br>
                                                ‚Ä¢ x indicates password in /etc/shadow<br>
                                                ‚Ä¢ UID 0 = root, 1-999 = system users<br>
                                                ‚Ä¢ UID 1000+ = regular users
                                            </div>
                                            <div style="border: 2px solid var(--accent-red); padding: 1rem; border-radius: var(--radius-md);">
                                                <strong>/etc/shadow</strong><br>
                                                <em>Secure password hashes (root-only)</em><br>
                                                Format: username:hash:lastchg:min:max:warn:inactive:expire<br><br>
                                                Example:<br>
                                                <code>alice:$6$salt$hash:18647:0:99999:7:::</code><br><br>
                                                ‚Ä¢ $6$ = SHA-512 hash<br>
                                                ‚Ä¢ Password aging controls<br>
                                                ‚Ä¢ Account expiration dates<br>
                                                ‚Ä¢ Failed login tracking
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <h4>üë• Group Management Files:</h4>
                                    <div class="diagram">
                                        <div style="font-family: var(--monospace); background: var(--tertiary-bg); padding: 1rem; border-radius: var(--radius-md);">
                                            <strong>/etc/group</strong><br>
                                            Format: groupname:password:GID:members<br><br>
                                            <strong>/etc/gshadow</strong> (secure group passwords)<br><br>
                                            Example groups:<br>
                                            root:x:0:<br>
                                            sudo:x:27:alice,bob<br>
                                            www-data:x:33:<br>
                                            alice:x:1000:
                                        </div>
                                    </div>
                                    
                                    <h4>üîç Understanding Permission Bits:</h4>
                                    <div class="diagram">
                                        <div style="font-family: var(--monospace); background: var(--tertiary-bg); padding: 1rem; border-radius: var(--radius-md);">
                                            <strong>drwxr-xr-x 2 alice developers 4096 Jan 1 12:00 directory</strong><br><br>
                                            Position breakdown:<br>
                                            [0] d = Directory ( - for file, l for link, etc.)<br>
                                            [1-3] rwx = Owner (alice) permissions<br>
                                            [4-6] r-x = Group (developers) permissions<br>
                                            [7-9] r-x = Others (everyone else) permissions<br><br>
                                            Numeric equivalent: 755<br>
                                            ‚Ä¢ Owner: 7 (4+2+1 = rwx)<br>
                                            ‚Ä¢ Group: 5 (4+0+1 = r-x)<br>
                                            ‚Ä¢ Others: 5 (4+0+1 = r-x)
                                        </div>
                                    </div>
                                    
                                    <h4>‚öôÔ∏è Special Permission Bits:</h4>
                                    <div class="trust-boundary">
                                        <div class="trust-zone high">
                                            <strong>SUID (Set User ID)</strong><br>
                                            ‚Ä¢ File executes as owner, not runner<br>
                                            ‚Ä¢ Example: /bin/passwd (runs as root)<br>
                                            ‚Ä¢ Numeric: 4000<br>
                                            ‚Ä¢ Display: rwsr-xr-x (s in owner execute)<br>
                                            ‚Ä¢ Security risk if misconfigured
                                        </div>
                                        <div class="trust-zone high">
                                            <strong>SGID (Set Group ID)</strong><br>
                                            ‚Ä¢ File executes with group permissions<br>
                                            ‚Ä¢ On directories: new files inherit group<br>
                                            ‚Ä¢ Numeric: 2000<br>
                                            ‚Ä¢ Display: rwxr-sr-x (s in group execute)<br>
                                            ‚Ä¢ Useful for collaboration
                                        </div>
                                        <div class="trust-zone low">
                                            <strong>Sticky Bit</strong><br>
                                            ‚Ä¢ On directories: only owner can delete<br>
                                            ‚Ä¢ Example: /tmp directory<br>
                                            ‚Ä¢ Numeric: 1000<br>
                                            ‚Ä¢ Display: rwxrwxrwt (t in others execute)<br>
                                            ‚Ä¢ Prevents file deletion by others
                                        </div>
                                    </div>
                                    
                                    <h4>üîÑ How Permission Checking Works:</h4>
                                    <div class="diagram data-flow-diagram">
                                        <div class="flow-node">Process tries to access file</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">1. Check: Is process UID == file owner?</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">Yes ‚Üí Apply owner permissions</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">No ‚Üí 2. Check: Is process GID in file's group?</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">Yes ‚Üí Apply group permissions</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">No ‚Üí 3. Apply others permissions</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">Final: Allow/deny based on requested operation</div>
                                    </div>
                                    
                                    <h4>üéØ Key Concepts in Detail:</h4>
                                    <table>
                                        <thead>
                                            <tr>
                                                <th>Concept</th>
                                                <th>Description</th>
                                                <th>Example</th>
                                                <th>Security Impact</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td><strong>Effective UID/GID</strong></td>
                                                <td>Who the process appears to be (after SUID/SGID)</td>
                                                <td>passwd runs as root (eUID=0)</td>
                                                <td>Privilege escalation vector if buggy</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Real UID/GID</strong></td>
                                                <td>Who actually started the process</td>
                                                <td>User alice runs passwd</td>
                                                <td>Used for resource limits, signals</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Saved UID/GID</strong></td>
                                                <td>Can switch back after dropping privileges</td>
                                                <td>Server starts as root, drops to www-data</td>
                                                <td>Allows privilege re-escalation if needed</td>
                                            </tr>
                                            <tr>
                                                <td><strong>umask</strong></td>
                                                <td>Default permission mask (subtracted)</td>
                                                <td>umask 022 ‚Üí files 644, dirs 755</td>
                                                <td>Prevents accidentally permissive files</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Access Control Lists</strong></td>
                                                <td>Extended permissions beyond owner/group/others</td>
                                                <td>Multiple users/groups with different perms</td>
                                                <td>More granular but complex management</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    
                                    <div class="callout callout-example">
                                        <h4>üîç Real-World Security Scenario: SUID Privilege Escalation</h4>
                                        <p><strong>Vulnerability:</strong> SUID binary with security flaw:</p>
                                        <pre><code>$ ls -l /usr/local/bin/vulnerable
-rwsr-xr-x 1 root root 12345 Jan 1 12:00 vulnerable

// Inside vulnerable.c:
void main() {
    char cmd[100];
    sprintf(cmd, "/bin/ls %s", argv[1]);
    system(cmd);  // Command injection!
}</code></pre>
                                        <p><strong>Attack:</strong> User runs: <code>vulnerable "; bash -p"</code></p>
                                        <p><strong>Result:</strong> Gets root shell because program runs as root (SUID).</p>
                                        <p><strong>Defenses:</strong> Minimal SUID programs, careful programming, privilege dropping where possible.</p>
                                        
                                        <p><strong>Scenario: World-Writable Directory</strong></p>
                                        <pre><code>$ ls -ld /tmp/uploads
drwxrwxrwx 2 root root 4096 Jan 1 12:00 /tmp/uploads
// Anyone can write files here</code></pre>
                                        <p><strong>Attack:</strong> Upload malicious script, trick admin to execute.</p>
                                        <p><strong>Defenses:</strong> Sticky bit, proper ownership, regular cleanup.</p>
                                    </div>
                                    
                                    <h4>üõ°Ô∏è Security Best Practices:</h4>
                                    <div class="trust-boundary">
                                        <div class="trust-zone high">
                                            <strong>Principle of Least Privilege</strong><br>
                                            ‚Ä¢ Users have minimum needed access<br>
                                            ‚Ä¢ Processes run with minimum privileges<br>
                                            ‚Ä¢ Regular privilege audits<br>
                                            ‚Ä¢ Remove unnecessary accounts
                                        </div>
                                        <div class="trust-zone high">
                                            <strong>Secure Defaults</strong><br>
                                            ‚Ä¢ Restrictive umask (027 or 077)<br>
                                            ‚Ä¢ No world-writable directories<br>
                                            ‚Ä¢ Regular permission audits<br>
                                            ‚Ä¢ Automated compliance checking
                                        </div>
                                        <div class="trust-zone low">
                                            <strong>Password Security</strong><br>
                                            ‚Ä¢ Strong password policies<br>
                                            ‚Ä¢ Password hashing (argon2, bcrypt)<br>
                                            ‚Ä¢ Account lockout policies<br>
                                            ‚Ä¢ Regular password changes
                                        </div>
                                        <div class="trust-zone high">
                                            <strong>Monitoring & Auditing</strong><br>
                                            ‚Ä¢ Log authentication attempts<br>
                                            ‚Ä¢ Monitor privilege escalation<br>
                                            ‚Ä¢ File integrity monitoring<br>
                                            ‚Ä¢ Regular security scans
                                        </div>
                                    </div>
                                    
                                    <h4>‚ö†Ô∏è Common Permission-Based Attacks:</h4>
                                    <ol>
                                        <li><strong>SUID/SGID Exploitation:</strong> Finding and exploiting vulnerable SUID binaries</li>
                                        <li><strong>World-Writable Files:</strong> Modifying configuration or script files</li>
                                        <li><strong>Weak Directory Permissions:</strong> Adding malicious files to PATH or library paths</li>
                                        <li><strong>Password Hash Cracking:</strong> Cracking weak hashes from /etc/shadow (if obtained)</li>
                                        <li><strong>Privilege Escalation via Groups:</strong> Exploiting group memberships (docker, sudo, etc.)</li>
                                        <li><strong>Symlink Attacks:</strong> Creating symlinks in writable directories</li>
                                    </ol>
                                    
                                    <h4>üîß Advanced Access Control Systems:</h4>
                                    <div class="diagram">
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                                            <div style="border: 2px solid var(--accent-purple); padding: 1rem; border-radius: var(--radius-md);">
                                                <strong>SELinux (Security-Enhanced Linux)</strong><br>
                                                ‚Ä¢ Mandatory Access Control (MAC)<br>
                                                ‚Ä¢ Policies define allowed operations<br>
                                                ‚Ä¢ Context-based (user:role:type:level)<br>
                                                ‚Ä¢ Default deny, explicit allow<br>
                                                ‚Ä¢ Complex but very secure
                                            </div>
                                            <div style="border: 2px solid var(--accent-orange); padding: 1rem; border-radius: var(--radius-md);">
                                                <strong>AppArmor</strong><br>
                                                ‚Ä¢ Path-based MAC system<br>
                                                ‚Ä¢ Simpler profile syntax<br>
                                                ‚Ä¢ Widely used (Ubuntu default)<br>
                                                ‚Ä¢ Per-application profiles<br>
                                                ‚Ä¢ Easier to manage than SELinux
                                            </div>
                                        </div>
                                    </div>
                                `,
                                whyItMatters: `
                                    <div class="callout callout-why">
                                        <h4>üõ°Ô∏è Why Understanding Users and Permissions Matters</h4>
                                        <p>This knowledge is critical for:</p>
                                        <ul>
                                            <li><strong>Privilege Escalation:</strong> Finding and exploiting permission misconfigurations to gain higher privileges</li>
                                            <li><strong>System Hardening:</strong> Configuring systems securely, removing unnecessary permissions</li>
                                            <li><strong>Forensics:</strong> Understanding who had access to what, tracking user activity</li>
                                            <li><strong>Secure Administration:</strong> Managing users and groups securely, implementing least privilege</li>
                                            <li><strong>Web Application Security:</strong> Understanding how web servers run (as specific users), file upload risks</li>
                                            <li><strong>Container Security:</strong> Understanding user namespaces, container breakout risks</li>
                                            <li><strong>Incident Response:</strong> Identifying compromised accounts, understanding attack scope</li>
                                        </ul>
                                        <p><strong>Example:</strong> The "Dirty COW" vulnerability (CVE-2016-5195) was a race condition that allowed any user to write to read-only memory mappings, leading to root privilege escalation. Understanding user permissions and how they interact with kernel memory was key to both exploiting and understanding this vulnerability.</p>
                                        <p>Permission misconfigurations are among the most common security findings in penetration tests. Understanding users, groups, and permissions helps you find these issues and understand their impact.</p>
                                    </div>
                                `,
                                misconceptions: `
                                    <div class="callout callout-misconception">
                                        <h4>‚ùå Common Misconceptions Debunked</h4>
                                        <p><strong>Myth:</strong> "Root can do anything."</p>
                                        <p><strong>Reality:</strong> While root has extensive privileges, some things are still restricted: 1) Can't modify read-only filesystems, 2) SELinux/AppArmor can restrict root, 3) Some kernel protections apply to all users, 4) Hardware limitations still apply.</p>
                                        
                                        <p><strong>Myth:</strong> "Files with 000 permissions are completely inaccessible."</p>
                                        <p><strong>Reality:</strong> Root can still access them. Also, if you have read permission on a directory, you can see the filename even if you can't read the file contents.</p>
                                        
                                        <p><strong>Myth:</strong> "Removing execute permission from a directory prevents access."</p>
                                        <p><strong>Reality:</strong> Execute permission on directories controls traversing into the directory (cd). Read permission controls listing contents (ls). Write permission controls creating/deleting files.</p>
                                        
                                        <p><strong>Myth:</strong> "SUID scripts are as secure as SUID binaries."</p>
                                        <p><strong>Reality:</strong> SUID shell scripts have additional security issues (race conditions, interpreter vulnerabilities). Most systems ignore SUID on scripts for this reason.</p>
                                        
                                        <p><strong>Myth:</strong> "Password hashes in /etc/shadow can't be cracked if strong passwords are used."</p>
                                        <p><strong>Reality:</strong> Given enough time and computing power, any hash can be cracked. The goal is to make it computationally infeasible. Modern hash algorithms (bcrypt, argon2) are designed to be slow.</p>
                                        
                                        <p><strong>Security Impact:</strong> These misconceptions lead to misconfigured systems and false sense of security.</p>
                                    </div>
                                `,
                                examples: [
                                    {
                                        title: "Real-World Example: Web Server Security",
                                        description: "Apache/Nginx typically run as user 'www-data' or 'apache'. Web files need read permission for this user. Upload directories need write but not execute. Configuration files should be readable only by root. Understanding these requirements prevents common misconfigurations like: 1) Web files owned by root (can't be read), 2) Upload directories with execute permission (allows code execution), 3) Configuration files world-readable (exposes secrets)."
                                    },
                                    {
                                        title: "Real-World Example: Database Security",
                                        description: "MySQL/PostgreSQL run as specific users (mysql, postgres). Database files must be readable/writable by these users but not others. Understanding this helps prevent: 1) Database files readable by web server user (data exposure), 2) Incorrect ownership causing startup failures, 3) Backup files with incorrect permissions exposing data."
                                    },
                                    {
                                        title: "Real-World Example: Docker Container Security",
                                        description: "By default, Docker containers run as root inside the container. This creates security risks if the container is compromised. Best practice is to: 1) Create non-root user in container, 2) Use USER directive in Dockerfile, 3) Consider user namespace remapping. Understanding Linux users and permissions is essential for container security."
                                    }
                                ],
                                exercises: [
                                    {
                                        level: "beginner",
                                        description: "Create multiple user accounts with different permissions. Experiment with: 1) File ownership and permissions, 2) Group membership and access, 3) SUID binaries (create a simple one), 4) Directory permissions. Use commands: useradd, groupadd, chmod, chown, chgrp, ls -l, id, groups.",
                                        goal: "Hands-on experience with user and permission management",
                                        expected: "Documentation of permission experiments and outcomes"
                                    },
                                    {
                                        level: "intermediate",
                                        description: "Perform a permission audit on a Linux system. Find: 1) World-writable files/directories, 2) SUID/SGID binaries, 3) Files owned by non-existent users, 4) Insecure permissions on sensitive files (/etc/shadow, .ssh directories). Write a script to automate this audit.",
                                        goal: "Learn to identify permission security issues",
                                        expected: "Audit report and automated audit script"
                                    },
                                    {
                                        level: "advanced",
                                        description: "Set up a vulnerable system with multiple permission-based vulnerabilities: 1) Weak SUID binary, 2) World-writable cron directory, 3) Misconfigured sudoers file, 4) Weak directory permissions. Then exploit each vulnerability to gain root access. Document the attack paths.",
                                        goal: "Practice privilege escalation through permission vulnerabilities",
                                        expected: "Vulnerable system setup and successful privilege escalation documentation"
                                    }
                                ],
                                mentalModels: `
                                    <div class="diagram">
                                        <div style="text-align: center; padding: 1rem;">
                                            <div style="border: 2px solid var(--accent-blue); padding: 1rem; margin: 0.5rem; display: inline-block; width: 45%;">
                                                <strong>Building Security</strong><br>
                                                ‚Ä¢ Building = System<br>
                                                ‚Ä¢ Tenant = User<br>
                                                ‚Ä¢ Apartment = Home directory<br>
                                                ‚Ä¢ Key = Password<br>
                                                ‚Ä¢ Master key = Root access<br>
                                                ‚Ä¢ Security guard = Kernel
                                            </div>
                                            <div style="border: 2px solid var(--accent-green); padding: 1rem; margin: 0.5rem; display: inline-block; width: 45%;">
                                                <strong>Office Building</strong><br>
                                                ‚Ä¢ Employee = User account<br>
                                                ‚Ä¢ Department = Group<br>
                                                ‚Ä¢ Office = Process<br>
                                                ‚Ä¢ Badge access = Permissions<br>
                                                ‚Ä¢ Master keycard = Root privileges<br>
                                                ‚Ä¢ Security policy = SELinux/AppArmor
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <p><strong>Mental Model 1: Hotel Keycards</strong></p>
                                    <ul>
                                        <li><strong>Guest = User:</strong> Has specific room access</li>
                                        <li><strong>Room number = UID:</strong> Unique identifier</li>
                                        <li><strong>Keycard = Authentication:</strong> Proves identity</li>
                                        <li><strong>Room access = File permissions:</strong> What you can enter</li>
                                        <li><strong>Master keycard = Root:</strong> Accesses all rooms</li>
                                        <li><strong>Hotel staff = System processes:</strong> Have specific access</li>
                                        <li><strong>Keycard expiration = Password aging:</strong> Needs periodic renewal</li>
                                    </ul>
                                    
                                    <p><strong>Mental Model 2: Government Security Clearance</strong></p>
                                    <ul>
                                        <li><strong>Citizen = User account:</strong> Basic identity</li>
                                        <li><strong>Security clearance = Privilege level:</strong> What you can access</li>
                                        <li><strong>Background check = Authentication:</strong> Verifies identity</li>
                                        <li><strong>Need-to-know = Least privilege:</strong> Only access what's needed</li>
                                        <li><strong>Compartmentalization = Process isolation:</strong> Secrets separated</li>
                                        <li><strong>President = Root:</strong> Ultimate authority (with checks)</li>
                                    </ul>
                                    
                                    <div class="callout callout-principle">
                                        <p><strong>First Principles Thinking:</strong> At the kernel level, every process has associated credentials (user ID, group IDs, capabilities). Every object (file, socket, process) has an owner and permissions. When a process tries to access an object, the kernel checks: 1) Are the process's credentials allowed? 2) Does the object's permission bits permit this operation? This check happens for every system call. All user/group management (passwd, shadow, group files) are just databases that provide information to the kernel. The actual enforcement is in the kernel's permission-checking code.</p>
                                    </div>
                                `
                            }
                        }
                    ]
                },
                {
                    id: "phase-1",
                    title: "PHASE 1 ‚Äî NETWORKING FROM ZERO TO DEEP UNDERSTANDING",
                    topics: [
                        {
                            id: "topic-1-1",
                            title: "Bits, bytes, encoding",
                            completed: false,
                            content: {
                                explanation: `
                                    <h3>üî¢ Bits, Bytes, and Encoding: The Language of Computers</h3>
                                    <p>All digital information ultimately reduces to bits (binary digits). Understanding how data is represented, stored, and transmitted is fundamental to computer science and security:</p>
                                    
                                    <div class="diagram">
                                        <div style="text-align: center; padding: 1rem;">
                                            <div style="border: 2px solid var(--accent-blue); padding: 0.5rem; margin: 0.5rem; display: inline-block;">
                                                <strong>Reality</strong><br>
                                                Physical World
                                            </div>
                                            <div style="margin: 1rem;">‚Üì Digital Representation ‚Üì</div>
                                            <div style="border: 2px solid var(--accent-green); padding: 0.5rem; margin: 0.5rem; display: inline-block;">
                                                <strong>Digital</strong><br>
                                                Bits & Bytes
                                            </div>
                                            <div style="margin: 1rem;">‚Üì Human Interpretation ‚Üì</div>
                                            <div style="border: 2px solid var(--accent-amber); padding: 0.5rem; margin: 0.5rem; display: inline-block;">
                                                <strong>Human</strong><br>
                                                Text, Images, Sound
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <h4>üî¢ The Binary Foundation:</h4>
                                    <div class="diagram">
                                        <div style="font-family: var(--monospace); background: var(--tertiary-bg); padding: 1rem; border-radius: var(--radius-md);">
                                            <strong>Binary (Base-2):</strong> 0 or 1<br>
                                            <strong>Bit:</strong> Single binary digit (b)<br>
                                            <strong>Nibble:</strong> 4 bits (half-byte)<br>
                                            <strong>Byte:</strong> 8 bits (B)<br>
                                            <strong>Word:</strong> Architecture-dependent (16, 32, 64 bits)<br><br>
                                            <strong>Size Prefixes:</strong><br>
                                            ‚Ä¢ Kilobyte (KB): 1,024 bytes (2¬π‚Å∞)<br>
                                            ‚Ä¢ Megabyte (MB): 1,024 KB (2¬≤‚Å∞)<br>
                                            ‚Ä¢ Gigabyte (GB): 1,024 MB (2¬≥‚Å∞)<br>
                                            ‚Ä¢ Terabyte (TB): 1,024 GB (2‚Å¥‚Å∞)
                                        </div>
                                    </div>
                                    
                                    <h4>üéØ Number Systems Comparison:</h4>
                                    <table>
                                        <thead>
                                            <tr>
                                                <th>Decimal</th>
                                                <th>Binary</th>
                                                <th>Hexadecimal</th>
                                                <th>Octal</th>
                                                <th>Explanation</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>0</td>
                                                <td>0000</td>
                                                <td>0x0</td>
                                                <td>0o0</td>
                                                <td>Zero in all systems</td>
                                            </tr>
                                            <tr>
                                                <td>10</td>
                                                <td>1010</td>
                                                <td>0xA</td>
                                                <td>0o12</td>
                                                <td>Decimal ten</td>
                                            </tr>
                                            <tr>
                                                <td>65</td>
                                                <td>01000001</td>
                                                <td>0x41</td>
                                                <td>0o101</td>
                                                <td>ASCII 'A'</td>
                                            </tr>
                                            <tr>
                                                <td>255</td>
                                                <td>11111111</td>
                                                <td>0xFF</td>
                                                <td>0o377</td>
                                                <td>Maximum byte value</td>
                                            </tr>
                                            <tr>
                                                <td>1,024</td>
                                                <td>10000000000</td>
                                                <td>0x400</td>
                                                <td>0o2000</td>
                                                <td>One kilobyte</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    
                                    <h4>üî§ Character Encoding Systems:</h4>
                                    <div class="trust-boundary">
                                        <div class="trust-zone high">
                                            <strong>ASCII (1963)</strong><br>
                                            ‚Ä¢ 7-bit, 128 characters<br>
                                            ‚Ä¢ English letters, digits, basic symbols<br>
                                            ‚Ä¢ Example: 'A' = 65 (0x41)<br>
                                            ‚Ä¢ Limited to English<br>
                                            ‚Ä¢ Basis for many encodings
                                        </div>
                                        <div class="trust-zone high">
                                            <strong>ISO-8859 / Latin-1</strong><br>
                                            ‚Ä¢ 8-bit, 256 characters<br>
                                            ‚Ä¢ Extended ASCII for European languages<br>
                                            ‚Ä¢ Different parts for different languages<br>
                                            ‚Ä¢ Example: '√©' = 233 (0xE9)<br>
                                            ‚Ä¢ Superseded by Unicode
                                        </div>
                                        <div class="trust-zone low">
                                            <strong>UTF-8 (Unicode)</strong><br>
                                            ‚Ä¢ Variable-length (1-4 bytes)<br>
                                            ‚Ä¢ Backward compatible with ASCII<br>
                                            ‚Ä¢ Supports all languages<br>
                                            ‚Ä¢ Web standard (over 95% of web)<br>
                                            ‚Ä¢ Example: 'üòÄ' = 0xF0 0x9F 0x98 0x80
                                        </div>
                                        <div class="trust-zone high">
                                            <strong>UTF-16 / UTF-32</strong><br>
                                            ‚Ä¢ Fixed/variable length<br>
                                            ‚Ä¢ Windows native (UTF-16)<br>
                                            ‚Ä¢ Java, .NET internal<br>
                                            ‚Ä¢ Less space-efficient than UTF-8<br>
                                            ‚Ä¢ Byte order issues (BOM)
                                        </div>
                                    </div>
                                    
                                    <h4>‚öôÔ∏è How UTF-8 Works (Variable Length):</h4>
                                    <div class="diagram">
                                        <div style="font-family: var(--monospace); background: var(--tertiary-bg); padding: 1rem; border-radius: var(--radius-md);">
                                            <strong>UTF-8 Encoding Rules:</strong><br>
                                            1-byte: 0xxxxxxx (ASCII: 0-127)<br>
                                            2-byte: 110xxxxx 10xxxxxx (128-2047)<br>
                                            3-byte: 1110xxxx 10xxxxxx 10xxxxxx (2048-65535)<br>
                                            4-byte: 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx (65536-1114111)<br><br>
                                            <strong>Examples:</strong><br>
                                            'A' (U+0041): 01000001 (1 byte, same as ASCII)<br>
                                            '√©' (U+00E9): 11000011 10101001 (2 bytes)<br>
                                            '‰∏≠' (U+4E2D): 11100100 10111000 10101101 (3 bytes)<br>
                                            'üòÄ' (U+1F600): 11110000 10011111 10011000 10000000 (4 bytes)
                                        </div>
                                    </div>
                                    
                                    <h4>üéØ Endianness: Byte Order Matters:</h4>
                                    <div class="diagram">
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                                            <div style="border: 2px solid var(--accent-blue); padding: 1rem; border-radius: var(--radius-md);">
                                                <strong>Big-Endian</strong><br>
                                                ‚Ä¢ Most significant byte first<br>
                                                ‚Ä¢ Network order (standard)<br>
                                                ‚Ä¢ Human-readable (like decimal)<br>
                                                ‚Ä¢ Used in: TCP/IP, Java, Motorola<br>
                                                Example: 0x12345678 stored as:<br>
                                                12 34 56 78
                                            </div>
                                            <div style="border: 2px solid var(--accent-green); padding: 1rem; border-radius: var(--radius-md);">
                                                <strong>Little-Endian</strong><br>
                                                ‚Ä¢ Least significant byte first<br>
                                                ‚Ä¢ x86/AMD64 native<br>
                                                ‚Ä¢ More efficient for arithmetic<br>
                                                ‚Ä¢ Used in: Windows, Linux on x86<br>
                                                Example: 0x12345678 stored as:<br>
                                                78 56 34 12
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <h4>üîç Data Representation Examples:</h4>
                                    <div class="diagram">
                                        <div style="font-family: var(--monospace); background: var(--tertiary-bg); padding: 1rem; border-radius: var(--radius-md);">
                                            <strong>String: "Hello"</strong><br>
                                            ASCII/UTF-8: 48 65 6C 6C 6F<br>
                                            Hex: H=0x48, e=0x65, l=0x6C, l=0x6C, o=0x6F<br><br>
                                            <strong>Integer: 1,000 (0x3E8)</strong><br>
                                            32-bit big-endian: 00 00 03 E8<br>
                                            32-bit little-endian: E8 03 00 00<br><br>
                                            <strong>Floating point: 3.14159</strong><br>
                                            IEEE 754 single precision: 40 49 0F DB<br>
                                            Binary: 0 10000000 10010010000111111011011
                                        </div>
                                    </div>
                                    
                                    <div class="callout callout-example">
                                        <h4>üîç Real-World Security Scenario: Encoding Issues</h4>
                                        <p><strong>Problem:</strong> Different systems interpret bytes differently based on encoding.</p>
                                        
                                        <p><strong>Example 1: XSS via UTF-7</strong></p>
                                        <pre><code>// Page with old encoding or missing charset
&lt;meta charset="UTF-7"&gt;
// Attack: +ADw-script+AD4-alert(1)+ADw-/script+AD4-
// Renders as: &lt;script&gt;alert(1)&lt;/script&gt;</code></pre>
                                        
                                        <p><strong>Example 2: SQL Injection via Encoding</strong></p>
                                        <pre><code>// Application checks for ' OR '1'='1
// But attacker sends UTF-8 encoded:
' OR '1'='1
// Where ' = %E2%80%99 (right single quotation mark)
// Might bypass naive filters</code></pre>
                                        
                                        <p><strong>Example 3: Path Traversal with Unicode</strong></p>
                                        <pre><code>// Check for ../ but attacker uses:
..%c0%af   (UTF-8 overlong encoding of /)
..%255c    (Double URL encoding)
..\\       (Windows path separator)</code></pre>
                                        
                                        <p><strong>Defenses:</strong> Consistent encoding (UTF-8), canonicalization, whitelist validation.</p>
                                    </div>
                                    
                                    <h4>üõ°Ô∏è Security Implications of Encoding:</h4>
                                    <ul>
                                        <li><strong>Injection Attacks:</strong> Bypassing filters through alternative encodings</li>
                                        <li><strong>Canonicalization Issues:</strong> Multiple representations of same data</li>
                                        <li><strong>Buffer Overflows:</strong> Different encodings = different byte counts</li>
                                        <li><strong>Information Disclosure:</strong> Encoding errors revealing system information</li>
                                        <li><strong>Hash Collisions:</strong> Crafting different inputs with same hash</li>
                                        <li><strong>Unicode Spoofing:</strong> Visually identical characters from different code points</li>
                                    </ul>
                                    
                                    <h4>‚ö†Ô∏è Common Encoding-Related Vulnerabilities:</h4>
                                    <ol>
                                        <li><strong>XSS with Alternative Encodings:</strong> UTF-7, ISO-8859-1 quirks</li>
                                        <li><strong>SQL Injection Bypass:</strong> Using char() functions, hex encoding</li>
                                        <li><strong>Directory Traversal:</strong> Alternative path separators, URL encoding</li>
                                        <li><strong>HTTP Parameter Pollution:</strong> Different encodings of same parameter</li>
                                        <li><strong>Unicode Normalization Issues:</strong> Precomposed vs decomposed characters</li>
                                        <li><strong>Homograph Attacks:</strong> Using similar-looking Unicode characters</li>
                                    </ol>
                                    
                                    <h4>üîß Working with Binary Data:</h4>
                                    <div class="trust-boundary">
                                        <div class="trust-zone high">
                                            <strong>Hex Dump Analysis</strong><br>
                                            ‚Ä¢ Reading raw byte data<br>
                                            ‚Ä¢ Identifying file signatures<br>
                                            ‚Ä¢ Manual protocol analysis<br>
                                            ‚Ä¢ Tools: xxd, hexdump, 010 Editor<br>
                                            ‚Ä¢ Example: PNG = 89 50 4E 47
                                        </div>
                                        <div class="trust-zone high">
                                            <strong>Bitwise Operations</strong><br>
                                            ‚Ä¢ AND, OR, XOR, NOT<br>
                                            ‚Ä¢ Bit shifting (<<, >><br>
                                            ‚Ä¢ Masking specific bits<br>
                                            ‚Ä¢ Cryptography fundamentals<br>
                                            ‚Ä¢ Network protocol parsing
                                        </div>
                                        <div class="trust-zone low">
                                            <strong>Byte Manipulation</strong><br>
                                            ‚Ä¢ Endian conversion<br>
                                            ‚Ä¢ Byte swapping<br>
                                            ‚Ä¢ Alignment considerations<br>
                                            ‚Ä¢ Structure packing<br>
                                            ‚Ä¢ Protocol implementation
                                        </div>
                                        <div class="trust-zone high">
                                            <strong>Binary Protocols</strong><br>
                                            ‚Ä¢ Fixed field sizes<br>
                                            ‚Ä¢ Bit-level specifications<br>
                                            ‚Ä¢ Network packet analysis<br>
                                            ‚Ä¢ File format reverse engineering<br>
                                            ‚Ä¢ Example: DNS, DHCP packets
                                        </div>
                                    </div>
                                `,
                                whyItMatters: `
                                    <div class="callout callout-why">
                                        <h4>üõ°Ô∏è Why Understanding Bits, Bytes, and Encoding Matters</h4>
                                        <p>This fundamental knowledge is essential for:</p>
                                        <ul>
                                            <li><strong>Exploit Development:</strong> Crafting shellcode, understanding memory layout, bit manipulation in exploits</li>
                                            <li><strong>Protocol Analysis:</strong> Reading network packets, reverse engineering proprietary protocols</li>
                                            <li><strong>Web Security:</strong> Understanding encoding-related XSS, SQL injection bypass techniques</li>
                                            <li><strong>Forensics:</strong> Analyzing file headers, recovering data from raw storage</li>
                                            <li><strong>Cryptography:</strong> Understanding how encryption algorithms work at the bit level</li>
                                            <li><strong>Malware Analysis:</strong> Decoding obfuscated payloads, understanding packers</li>
                                            <li><strong>Secure Coding:</strong> Avoiding encoding-related vulnerabilities, proper string handling</li>
                                        </ul>
                                        <p><strong>Example:</strong> The "Unicode vulnerability" in IIS (MS00-078) allowed directory traversal using UTF-8 encoded characters. The server decoded %c0%af as / but the security check didn't recognize it as a path separator. Understanding UTF-8 encoding was key to both exploiting and fixing this vulnerability.</p>
                                        <p>Encoding issues are at the heart of many injection attacks. Understanding how data is represented helps you find these vulnerabilities and understand why they exist.</p>
                                    </div>
                                `,
                                misconceptions: `
                                    <div class="callout callout-misconception">
                                        <h4>‚ùå Common Misconceptions Debunked</h4>
                                        <p><strong>Myth:</strong> "UTF-8 is just extended ASCII."</p>
                                        <p><strong>Reality:</strong> UTF-8 is a variable-length encoding that's backward compatible with ASCII for the first 128 characters. Non-ASCII characters use 2-4 bytes with specific bit patterns.</p>
                                        
                                        <p><strong>Myth:</strong> "A kilobyte is 1,000 bytes."</p>
                                        <p><strong>Reality:</strong> In computing, kilo typically means 1,024 (2¬π‚Å∞) due to binary nature. Storage manufacturers use 1,000 for marketing. The IEC standardized kibibyte (KiB) for 1,024, but usage varies.</p>
                                        
                                        <p><strong>Myth:</strong> "All text is ASCII."</p>
                                        <p><strong>Reality:</strong> ASCII only covers English basic characters. Most languages need Unicode. Even "plain text" has an encoding (UTF-8, ISO-8859, etc.).</p>
                                        
                                        <p><strong>Myth:</strong> "Hexadecimal is just another way to write numbers."</p>
                                        <p><strong>Reality:</strong> Hex is base-16, which aligns perfectly with bytes (2 hex digits = 1 byte). This makes it ideal for representing binary data compactly and readably.</p>
                                        
                                        <p><strong>Myth:</strong> "Endianness doesn't matter in high-level programming."</p>
                                        <p><strong>Reality:</strong> Endianness affects: 1) Network communication, 2) File formats, 3) Inter-process communication between different architectures, 4) Cryptography (hash values).</p>
                                        
                                        <p><strong>Security Impact:</strong> These misconceptions lead to encoding-related vulnerabilities, data corruption, and security bypasses.</p>
                                    </div>
                                `,
                                examples: [
                                    {
                                        title: "Real-World Example: HTTP Charset Vulnerabilities",
                                        description: "Web browsers use the Content-Type header to determine encoding. If missing or wrong, browsers may guess, leading to: 1) UTF-7 XSS (if guessed as UTF-7), 2) Character set smuggling (different interpretations client vs server), 3) Content spoofing. The fix is to always specify charset (e.g., Content-Type: text/html; charset=utf-8) and validate input consistently."
                                    },
                                    {
                                        title: "Real-World Example: File Upload Bypasses",
                                        description: "File upload filters often check file signatures (magic numbers). Attackers can: 1) Add GIF headers to PHP files (GIF89a; <?php ...), 2) Use alternative encodings, 3) Manipulate MIME types. Understanding binary file formats and encodings helps both attack and defend file upload functionality."
                                    },
                                    {
                                        title: "Real-World Example: Password Hash Cracking",
                                        description: "Password hashes are binary data. Understanding encoding matters for: 1) Hash representation (hex vs base64), 2) Hashcat mask attacks (character sets), 3) Rainbow tables (encoding affects precomputation). The same password encoded differently (UTF-8 vs UTF-16) produces different hashes."
                                    }
                                ],
                                exercises: [
                                    {
                                        level: "beginner",
                                        description: "Convert between number systems: 1) Convert your age to binary and hex, 2) Convert 0xDEADBEEF to decimal and binary, 3) Perform bitwise operations: 0x0F & 0xF0, 0x0F | 0xF0, 0x0F ^ 0xF0. Write a program that prints characters 0-255 and their hex values.",
                                        goal: "Practice number system conversions and bitwise operations",
                                        expected: "Completed conversions and simple program demonstrating character encoding"
                                    },
                                    {
                                        level: "intermediate",
                                        description: "Create a program that demonstrates encoding issues: 1) Read a file with different encodings (UTF-8, UTF-16, ISO-8859-1), 2) Show how the same bytes are interpreted differently, 3) Implement a UTF-8 validator, 4) Demonstrate a homograph attack (lookalike characters).",
                                        goal: "Understand practical encoding issues and validation",
                                        expected: "Program demonstrating encoding interpretation differences and validation"
                                    },
                                    {
                                        level: "advanced",
                                        description: "Analyze a network protocol at the binary level. Use Wireshark to capture DNS packets. Write a program that manually parses DNS packets: 1) Read raw bytes, 2) Parse header fields (ID, flags, counts), 3) Parse questions and answers, 4) Handle name compression. Compare with Wireshark's parsing.",
                                        goal: "Deep understanding of binary protocol parsing",
                                        expected: "DNS packet parser that matches Wireshark's interpretation"
                                    }
                                ],
                                mentalModels: `
                                    <div class="diagram">
                                        <div style="text-align: center; padding: 1rem;">
                                            <div style="border: 2px solid var(--accent-blue); padding: 1rem; margin: 0.5rem; display: inline-block; width: 45%;">
                                                <strong>Alphabet Analogy</strong><br>
                                                ‚Ä¢ Letters = Bits (0/1)<br>
                                                ‚Ä¢ Words = Bytes (groups of bits)<br>
                                                ‚Ä¢ Sentences = Data structures<br>
                                                ‚Ä¢ Language rules = Encoding scheme<br>
                                                ‚Ä¢ Translation = Character encoding
                                            </div>
                                            <div style="border: 2px solid var(--accent-green); padding: 1rem; margin: 0.5rem; display: inline-block; width: 45%;">
                                                <strong>Building Blocks</strong><br>
                                                ‚Ä¢ LEGO bricks = Bits<br>
                                                ‚Ä¢ LEGO pieces = Bytes<br>
                                                ‚Ä¢ LEGO models = Data<br>
                                                ‚Ä¢ Instruction manual = Protocol<br>
                                                ‚Ä¢ Different sets = Encodings
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <p><strong>Mental Model 1: Morse Code</strong></p>
                                    <ul>
                                        <li><strong>Dot/Dash = Bits (0/1):</strong> Basic units</li>
                                        <li><strong>Letters = Bytes:</strong> Groups of dots/dashes</li>
                                        <li><strong>Codebook = Encoding:</strong> Mapping to characters</li>
                                        <li><strong>Timing = Clock/synchronization:</strong> When bits are read</li>
                                        <li><strong>Prosigns = Control characters:</strong> Special meanings</li>
                                        <li><strong>Different languages = Different encodings:</strong> American vs Continental Morse</li>
                                    </ul>
                                    
                                    <p><strong>Mental Model 2: Color Representation</strong></p>
                                    <ul>
                                        <li><strong>RGB values = Binary data:</strong> Three numbers (0-255)</li>
                                        <li><strong>Color space = Encoding:</strong> How numbers map to colors</li>
                                        <li><strong>sRGB vs Adobe RGB = UTF-8 vs UTF-16:</strong> Different standards</li>
                                        <li><strong>Hex color codes = Hexadecimal representation:</strong> #FF0000 = red</li>
                                        <li><strong>Color profiles = Character sets:</strong> Different interpretations</li>
                                        <li><strong>Gamut = Character repertoire:</strong> What can be represented</li>
                                    </ul>
                                    
                                    <div class="callout callout-principle">
                                        <p><strong>First Principles Thinking:</strong> At the physical level, computers manipulate electrical voltages (high/low, 1/0). Groups of these bits form bytes. Bytes represent numbers in base-256. We create encodings to map these numbers to meaningful symbols (characters, instructions, etc.). All digital data is ultimately numbers. Security issues arise when: 1) Different systems interpret the same numbers differently (encoding mismatches), 2) Numbers can be manipulated to cause unexpected behavior (buffer overflows), 3) The mapping between numbers and meaning can be subverted (injection attacks).</p>
                                    </div>
                                `
                            }
                        },
                        {
                            id: "topic-1-2",
                            title: "IP addresses and subnets",
                            completed: false,
                            content: {
                                explanation: `
                                    <h3>üåê IP Addresses and Subnets: Internet Routing Fundamentals</h3>
                                    <p>Understanding IP addressing and subnetting is essential for network design, troubleshooting, and security analysis. This knowledge forms the foundation of how devices communicate on the internet:</p>
                                    
                                    <div class="diagram">
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                                            <div style="border: 3px solid var(--accent-blue); padding: 1.5rem; border-radius: var(--radius-md);">
                                                <h4 style="color: var(--accent-blue); margin-top: 0;">IPv4 (Internet Protocol Version 4)</h4>
                                                <p><strong>32-bit addresses</strong> (4.3 billion possible)</p>
                                                <ul>
                                                    <li><strong>Format:</strong> Dotted decimal (192.168.1.1)</li>
                                                    <li><strong>Exhausted:</strong> 2011 (NAT extended life)</li>
                                                    <li><strong>Address space:</strong> 0.0.0.0 to 255.255.255.255</li>
                                                    <li><strong>Still dominant:</strong> ~70% of internet traffic</li>
                                                    <li><strong>Private ranges:</strong> 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16</li>
                                                </ul>
                                            </div>
                                            <div style="border: 3px solid var(--accent-green); padding: 1.5rem; border-radius: var(--radius-md);">
                                                <h4 style="color: var(--accent-green); margin-top: 0;">IPv6 (Internet Protocol Version 6)</h4>
                                                <p><strong>128-bit addresses</strong> (3.4√ó10¬≥‚Å∏ possible)</p>
                                                <ul>
                                                    <li><strong>Format:</strong> Hexadecimal (2001:0db8:85a3::8a2e:0370:7334)</li>
                                                    <li><strong>Solution:</strong> To IPv4 exhaustion</li>
                                                    <li><strong>Features:</strong> Built-in security, autoconfiguration</li>
                                                    <li><strong>Adoption:</strong> ~30% of Google traffic</li>
                                                    <li><strong>No NAT needed:</strong> Every device can have public IP</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <h4>üî¢ IPv4 Address Structure:</h4>
                                    <div class="diagram">
                                        <div style="font-family: var(--monospace); background: var(--tertiary-bg); padding: 1rem; border-radius: var(--radius-md);">
                                            <strong>IP Address: 192.168.1.100</strong><br>
                                            Binary: 11000000.10101000.00000001.01100100<br><br>
                                            <strong>Subnet Mask: 255.255.255.0</strong><br>
                                            Binary: 11111111.11111111.11111111.00000000<br><br>
                                            <strong>Network Portion:</strong> First 24 bits (192.168.1)<br>
                                            <strong>Host Portion:</strong> Last 8 bits (.100)<br><br>
                                            <strong>CIDR Notation:</strong> 192.168.1.100/24
                                        </div>
                                    </div>
                                    
                                    <h4>üéØ IPv4 Address Classes (Historical):</h4>
                                    <table>
                                        <thead>
                                            <tr>
                                                <th>Class</th>
                                                <th>Range</th>
                                                <th>Default Mask</th>
                                                <th>Network Bits</th>
                                                <th>Host Bits</th>
                                                <th>Networks</th>
                                                <th>Hosts per Network</th>
                                                <th>Purpose</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>A</td>
                                                <td>1.0.0.0 - 127.255.255.255</td>
                                                <td>255.0.0.0 (/8)</td>
                                                <td>8</td>
                                                <td>24</td>
                                                <td>126</td>
                                                <td>16,777,214</td>
                                                <td>Large organizations</td>
                                            </tr>
                                            <tr>
                                                <td>B</td>
                                                <td>128.0.0.0 - 191.255.255.255</td>
                                                <td>255.255.0.0 (/16)</td>
                                                <td>16</td>
                                                <td>16</td>
                                                <td>16,384</td>
                                                <td>65,534</td>
                                                <td>Medium organizations</td>
                                            </tr>
                                            <tr>
                                                <td>C</td>
                                                <td>192.0.0.0 - 223.255.255.255</td>
                                                <td>255.255.255.0 (/24)</td>
                                                <td>24</td>
                                                <td>8</td>
                                                <td>2,097,152</td>
                                                <td>254</td>
                                                <td>Small organizations</td>
                                            </tr>
                                            <tr>
                                                <td>D</td>
                                                <td>224.0.0.0 - 239.255.255.255</td>
                                                <td>N/A</td>
                                                <td>N/A</td>
                                                <td>N/A</td>
                                                <td>N/A</td>
                                                <td>N/A</td>
                                                <td>Multicast</td>
                                            </tr>
                                            <tr>
                                                <td>E</td>
                                                <td>240.0.0.0 - 255.255.255.255</td>
                                                <td>N/A</td>
                                                <td>N/A</td>
                                                <td>N/A</td>
                                                <td>N/A</td>
                                                <td>N/A</td>
                                                <td>Experimental</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <p><em>Note: Classful addressing is obsolete. CIDR (Classless Inter-Domain Routing) replaced it in 1993.</em></p>
                                    
                                    <h4>‚öôÔ∏è Subnetting: Breaking Networks into Smaller Pieces</h4>
                                    <p>Subnetting allows efficient use of IP address space by dividing large networks into smaller, manageable subnets:</p>
                                    
                                    <div class="diagram data-flow-diagram">
                                        <div class="flow-node">Large Network: 192.168.0.0/16 (65,534 hosts)</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">Subdivide into /24 subnets</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">192.168.1.0/24 (254 hosts)</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">192.168.2.0/24 (254 hosts)</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">192.168.3.0/24 (254 hosts)</div>
                                        <div class="flow-arrow"></div>
                                        <div class="flow-node">... 254 more subnets ...</div>
                                    </div>
                                    
                                    <h4>üîç Subnet Calculation Example:</h4>
                                    <div class="diagram">
                                        <div style="font-family: var(--monospace); background: var(--tertiary-bg); padding: 1rem; border-radius: var(--radius-md);">
                                            <strong>Given: 192.168.1.100/27</strong><br><br>
                                            <strong>Step 1: Determine subnet mask</strong><br>
                                            /27 = 27 network bits = 255.255.255.224<br>
                                            Mask in binary: 11111111.11111111.11111111.11100000<br><br>
                                            <strong>Step 2: Find network address</strong><br>
                                            IP:   192.168.1.100 = 11000000.10101000.00000001.01100100<br>
                                            Mask: 255.255.255.224 = 11111111.11111111.11111111.11100000<br>
                                            AND:  192.168.1.96  = 11000000.10101000.00000001.01100000<br><br>
                                            <strong>Step 3: Calculate range</strong><br>
                                            Network:   192.168.1.96<br>
                                            First host: 192.168.1.97<br>
                                            Last host:  192.168.1.126<br>
                                            Broadcast: 192.168.1.127<br>
                                            Total hosts: 30 (2‚Åµ - 2)
                                        </div>
                                    </div>
                                    
                                    <h4>üéØ Special IP Address Ranges:</h4>
                                    <div class="trust-boundary">
                                        <div class="trust-zone high">
                                            <strong>Private Addresses (RFC 1918)</strong><br>
                                            ‚Ä¢ 10.0.0.0/8 (16.7M addresses)<br>
                                            ‚Ä¢ 172.16.0.0/12 (1M addresses)<br>
                                            ‚Ä¢ 192.168.0.0/16 (65K addresses)<br>
                                            ‚Ä¢ Not routable on public internet<br>
                                            ‚Ä¢ Used behind NAT
                                        </div>
                                        <div class="trust-zone high">
                                            <strong>Loopback Addresses</strong><br>
                                            ‚Ä¢ 127.0.0.0/8 (usually 127.0.0.1)<br>
                                            ‚Ä¢ Refers to local machine<br>
                                            ‚Ä¢ Used for testing/development<br>
                                            ‚Ä¢ Never leaves the computer
                                        </div>
                                        <div class="trust-zone low">
                                            <strong>APIPA (Automatic Private IP)</strong><br>
                                            ‚Ä¢ 169.254.0.0/16<br>
                                            ‚Ä¢ Assigned when DHCP fails<br>
                                            ‚Ä¢ Windows: APIPA<br>
                                            ‚Ä¢ Linux: IPv4LL<br>
                                            ‚Ä¢ Link-local only
                                        </div>
                                        <div class="trust-zone high">
                                            <strong>Multicast Addresses</strong><br>
                                            ‚Ä¢ 224.0.0.0/4<br>
                                            ‚Ä¢ One-to-many communication<br>
                                            ‚Ä¢ Examples:<br>
                                              - 224.0.0.1: All hosts<br>
                                              - 224.0.0.2: All routers<br>
                                              - 224.0.0.5: OSPF
                                        </div>
                                    </div>
                                    
                                    <h4>üî¢ IPv6 Deep Dive:</h4>
                                    <div class="diagram">
                                        <div style="font-family: var(--monospace); background: var(--tertiary-bg); padding: 1rem; border-radius: var(--radius-md);">
                                            <strong>IPv6 Address: 2001:0db8:85a3:0000:0000:8a2e:0370:7334</strong><br>
                                            ‚Ä¢ 8 groups of 4 hexadecimal digits<br>
                                            ‚Ä¢ Each group = 16 bits, total 128 bits<br><br>
                                            <strong>Compressed form:</strong> 2001:db8:85a3::8a2e:370:7334<br>
                                            ‚Ä¢ Leading zeros omitted<br>
                                            ‚Ä¢ One :: for consecutive zero groups<br><br>
                                            <strong>Subnetting:</strong> /64 is standard (64 network, 64 host bits)<br>
                                            ‚Ä¢ Network: 2001:db8:85a3::/64<br>
                                            ‚Ä¢ Host: Usually from MAC (EUI-64) or random
                                        </div>
                                    </div>
                                    
                                    <div class="callout callout-example">
                                        <h4>üîç Real-World Security Scenario: Network Reconnaissance</h4>
                                        <p><strong>Problem:</strong> Attackers map network structure to plan attacks.</p>
                                        
                                        <p><strong>Example: Subnet Discovery</strong></p>
                                        <pre><code># Nmap subnet scan
nmap -sn 192.168.1.0/24

# Finds live hosts, then:
nmap -sS 192.168.1.1-254
# Scans entire subnet for open ports</code></pre>
                                        
                                        <p><strong>Example: Route Tracing</strong></p>
                                        <pre><code>traceroute 8.8.8.8
# Shows path through network
# Reveals internal network structure
# Identifies security zones</code></pre>
                                        
                                        <p><strong>Example: Network Mapping from Outside</strong></p>
                                        <pre><code># Find company's IP ranges
whois company.com
# Get allocated IP blocks
# Then scan those blocks

# DNS enumeration
nslookup
> set type=any
> company.com
# Find subdomains and their IPs</code></pre>
                                        
                                        <p><strong>Defenses:</strong> Network segmentation, proper firewall rules, minimize exposed services, monitoring for scanning activity.</p>
                                    </div>
                                    
                                    <h4>üõ°Ô∏è Security Implications of IP Addressing:</h4>
                                    <ul>
                                        <li><strong>Network Mapping:</strong> Understanding subnet structure helps attackers plan lateral movement</li>
                                        <li><strong>IP Spoofing:</strong> Forging source IP addresses to bypass filters or reflect attacks</li>
                                        <li><strong>Subnet-based ACLs:</strong> Firewall rules based on IP ranges can be bypassed if too broad</li>
                                        <li><strong>IPv6 Security:</strong> Larger address space makes scanning harder but introduces new issues</li>
                                        <li><strong>NAT Limitations:</strong> Provides obscurity but not real security</li>
                                        <li><strong>Multicast Attacks:</strong> Exploiting multicast protocols for amplification</li>
                                    </ul>
                                    
                                    <h4>‚ö†Ô∏è Common IP/Subnet Related Attacks:</h4>
                                    <ol>
                                        <li><strong>IP Spoofing:</strong> Forging source IP to impersonate trusted systems</li>
                                        <li><strong>Subnet Scanning:</strong> Discovering live hosts and network structure</li>
                                        <li><strong>ARP Poisoning:</strong> Within local subnet to intercept traffic</li>
                                        <li><strong>Smurf Attack:</strong> Using broadcast addresses for amplification</li>
                                        <li><strong>Route Hijacking:</strong> BGP attacks to redirect traffic</li>
                                        <li><strong>IPv6 Transition Attacks:</strong> Exploiting IPv4/IPv6 coexistence</li>
                                    </ol>
                                    
                                    <h4>üîß Practical Subnetting Exercises:</h4>
                                    <div class="trust-boundary">
                                        <div class="trust-zone high">
                                            <strong>Scenario 1: Office Network</strong><br>
                                            ‚Ä¢ Need 5 departments<br>
                                            ‚Ä¢ Each needs ~50 hosts<br>
                                            ‚Ä¢ Given: 192.168.0.0/24<br>
                                            ‚Ä¢ Task: Create subnets<br>
                                            ‚Ä¢ Solution: /26 subnets (62 hosts each)
                                        </div>
                                        <div class="trust-zone high">
                                            <strong>Scenario 2: DMZ Design</strong><br>
                                            ‚Ä¢ Web servers need public IPs<br>
                                            ‚Ä¢ Database needs private IPs<br>
                                            ‚Ä¢ Firewall between them<br>
                                            ‚Ä¢ Given: Public /28, Private /24<br>
                                            ‚Ä¢ Task: Assign appropriate ranges
                                        </div>
                                        <div class="trust-zone low">
                                            <strong>Scenario 3: VPN Configuration</strong><br>
                                            ‚Ä¢ Remote users need IPs<br>
                                            ‚Ä¢ Must not conflict with office<br>
                                            ‚Ä¢ Given: Office uses 10.1.0.0/16<br>
                                            ‚Ä¢ Task: Choose VPN subnet<br>
                                            ‚Ä¢ Solution: 10.2.0.0/24
                                        </div>
                                        <div class="trust-zone high">
                                            <strong>Scenario 4: Cloud VPC</strong><br>
                                            ‚Ä¢ Multiple availability zones<br>
                                            ‚Ä¢ Each needs subnet<br>
                                            ‚Ä¢ CIDR block: 10.0.0.0/16<br>
                                            ‚Ä¢ Task: Create /20 subnets per AZ<br>
                                            ‚Ä¢ Leaves room for growth
                                        </div>
                                    </div>
                                `,
                                whyItMatters: `
                                    <div class="callout callout-why">
                                        <h4>üõ°Ô∏è Why Understanding IP Addresses and Subnets Matters</h4>
                                        <p>This knowledge is critical for:</p>
                                        <ul>
                                            <li><strong>Network Security:</strong> Designing secure network architectures with proper segmentation</li>
                                            <li><strong>Penetration Testing:</strong> Mapping target networks, understanding attack paths</li>
                                            <li><strong>Incident Response:</strong> Tracing malicious activity across network segments</li>
                                            <li><strong>Firewall Configuration:</strong> Creating effective ACLs based on IP ranges</li>
                                            <li><strong>VPN Setup:</strong> Ensuring no IP conflicts between networks</li>
                                            <li><strong>Cloud Security:</strong> Understanding VPCs, subnets, and security groups</li>
                                            <li><strong>Forensics:</strong> Analyzing network traffic, identifying suspicious IPs</li>
                                        </ul>
                                        <p><strong>Example:</strong> The "Mirai" botnet (2016) exploited default credentials on IoT devices. It scanned entire subnets for vulnerable devices. Understanding IP addressing helped both the attackers (to find targets) and defenders (to identify scanning patterns and block malicious IP ranges).</p>
                                        <p>Network segmentation is a fundamental security control. Understanding IP addressing and subnetting is essential to implement it effectively and understand when it's been bypassed.</p>
                                    </div>
                                `,
                                misconceptions: `
                                    <div class="callout callout-misconception">
                                        <h4>‚ùå Common Misconceptions Debunked</h4>
                                        <p><strong>Myth:</strong> "More specific subnets (smaller masks) are always more secure."</p>
                                        <p><strong>Reality:</strong> While smaller subnets limit broadcast domains and contain breaches, they also increase complexity and management overhead. The right balance depends on the use case.</p>
                                        
                                        <p><strong>Myth:</strong> "Private IP addresses (192.168.x.x) are secure because they're not routable."</p>
                                        <p><strong>Reality:</strong> Private IPs are only non-routable on the public internet. Within a network, they're fully accessible. Also, VPNs can make private networks accessible remotely.</p>
                                        
                                        <p><strong>Myth:</strong> "All devices in the same subnet can communicate directly."</p>
                                        <p><strong>Reality:</strong> Switches and VLANs can isolate devices within the same IP subnet. Layer 2 separation can exist even with same IP network.</p>
                                        
                                        <p><strong>Myth:</strong> "IPv6 eliminates the need for NAT and therefore is less secure."</p>
                                        <p><strong>Reality:</strong> NAT provides obscurity, not security. IPv6 has built-in IPsec support and other security features. Proper firewalling is needed regardless of addressing scheme.</p>
                                        
                                        <p><strong>Myth:</strong> "You can tell if an IP is malicious by its geographic location."</p>
                                        <p><strong>Reality:</strong> IP geolocation is approximate. Attackers use compromised systems worldwide. Also, cloud services mean IPs don't correspond to physical location.</p>
                                        
                                        <p><strong>Security Impact:</strong> These misconceptions lead to poor network design, false sense of security, and ineffective security controls.</p>
                                    </div>
                                `,
                                examples: [
                                    {
                                        title: "Real-World Example: Enterprise Network Design",
                                        description: "A typical enterprise uses: 1) /24 subnets for user VLANs (one per floor/department), 2) /30 or /31 for point-to-point links between routers, 3) Larger subnets for server farms, 4) DMZ with public IPs. Understanding subnetting helps design this efficiently and securely, ensuring proper isolation between segments."
                                    },
                                    {
                                        title: "Real-World Example: Cloud VPC Security",
                                        description: "AWS VPCs use CIDR blocks (like 10.0.0.0/16). Within this, subnets are created in different availability zones. Security groups and NACLs control traffic between subnets. Understanding IP addressing is essential for: 1) Avoiding IP conflicts, 2) Configuring proper routing, 3) Implementing least privilege between tiers (web, app, database)."
                                    },
                                    {
                                        title: "Real-World Example: Incident Response",
                                        description: "During a breach, analysts trace malicious activity: 1) Which internal IP was compromised, 2) What other IPs it communicated with, 3) Whether it moved to other subnets. Understanding subnet structure helps contain the breach (isolate affected subnets) and understand the attack's scope."
                                    }
                                ],
                                exercises: [
                                    {
                                        level: "beginner",
                                        description: "Given the network 192.168.0.0/24, create 4 equal-sized subnets. For each subnet, calculate: 1) Subnet mask, 2) Network address, 3) First and last usable IP, 4) Broadcast address, 5) Total hosts. Document your work.",
                                        goal: "Practice basic subnetting calculations",
                                        expected: "Complete subnet breakdown for 4 subnets from /24 network"
                                    },
                                    {
                                        level: "intermediate",
                                        description: "Design a network for a small company with: 1) Office staff (50 devices), 2) Servers (20 devices), 3) Guests (wireless, 100 devices), 4) Network equipment (10 devices). Start with 10.10.0.0/16. Create appropriate subnets, ensuring room for growth. Create a network diagram with IP ranges.",
                                        goal: "Design a complete network with appropriate subnet sizing",
                                        expected: "Network design document with subnet allocations and diagram"
                                    },
                                    {
                                        level: "advanced",
                                        description: "Use Python to create a subnet calculator. Functions should: 1) Validate IP/CIDR input, 2) Calculate network, broadcast, range, 3) Check if IP is in subnet, 4) Generate random IPs from subnet, 5) Calculate supernets (route summarization). Test with various inputs.",
                                        goal: "Implement subnet calculations programmatically",
                                        expected: "Python subnet calculator with comprehensive functionality"
                                    }
                                ],
                                mentalModels: `
                                    <div class="diagram">
                                        <div style="text-align: center; padding: 1rem;">
                                            <div style="border: 2px solid var(--accent-blue); padding: 1rem; margin: 0.5rem; display: inline-block; width: 45%;">
                                                <strong>Postal System</strong><br>
                                                ‚Ä¢ ZIP code = Network portion<br>
                                                ‚Ä¢ Street address = Host portion<br>
                                                ‚Ä¢ City = Subnet<br>
                                                ‚Ä¢ Mail sorting = Routing<br>
                                                ‚Ä¢ Return address = Source IP<br>
                                                ‚Ä¢ Destination = Destination IP
                                            </div>
                                            <div style="border: 2px solid var(--accent-green); padding: 1rem; margin: 0.5rem; display: inline-block; width: 45%;">
                                                <strong>Phone Numbers</strong><br>
                                                ‚Ä¢ Country code = Major network<br>
                                                ‚Ä¢ Area code = Subnet<br>
                                                ‚Ä¢ Local number = Host<br>
                                                ‚Ä¢ Switchboard = Router<br>
                                                ‚Ä¢ Caller ID = Source IP<br>
                                                ‚Ä¢ Dialed number = Destination IP
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <p><strong>Mental Model 1: Apartment Building</strong></p>
                                    <ul>
                                        <li><strong>Building address = Network address:</strong> Where the building is</li>
                                        <li><strong>Apartment numbers = Host addresses:</strong> Individual units</li>
                                        <li><strong>Floor = Subnet:</strong> Group of apartments</li>
                                        <li><strong>Mailroom = Router:</strong> Distributes to correct floor</li>
                                        <li><strong>Intercom system = Switch:</strong> Connects within floor</li>
                                        <li><strong>Package delivery = Packet:</strong> Data with source/destination</li>
                                    </ul>
                                    
                                    <p><strong>Mental Model 2: Library System</strong></p>
                                    <ul>
                                        <li><strong>Library system = Internet:</strong> Collection of libraries</li>
                                        <li><strong>Individual library = Network:</strong> Has its own collection</li>
                                        <li><strong>Section in library = Subnet:</strong> Fiction, nonfiction, etc.</li>
                                        <li><strong>Bookshelf in section = VLAN:</strong> Further subdivision</li>
                                        <li><strong>Book = Host:</strong> Individual item with unique ID</li>
                                        <li><strong>Library catalog = DNS:</strong> Maps names to locations</li>
                                        <li><strong>Inter-library loan = Routing:</strong> Between different networks</li>
                                    </ul>
                                    
                                    <div class="callout callout-principle">
                                        <p><strong>First Principles Thinking:</strong> IP addresses are hierarchical identifiers. The network portion tells routers how to get packets to the right network. The host portion tells the final router which specific device within that network. Subnet masks define where the boundary is between network and host portions. This hierarchy enables scalable routing - routers only need to know about networks, not individual hosts. Security controls (firewalls, ACLs) can be applied at these hierarchical boundaries. Problems occur when the hierarchy doesn't match the actual network topology or security requirements.</p>
                                    </div>
                                `
                            }
                        }
                    ]
                }
            ]
        };

        // ===== APPLICATION STATE =====
        let currentTheme = 'dark';
        let currentPhaseId = 'phase-0';
        let currentTopicId = 'topic-0-1';
        let userNotes = '';
        let progress = {};

        // ===== DOM ELEMENTS =====
        const sidebar = document.getElementById('sidebar');
        const mainContent = document.getElementById('main-content');
        const phasesList = document.getElementById('phases-list');
        const progressFill = document.getElementById('progress-fill');
        const progressText = document.getElementById('progress-text');
        const themeToggle = document.getElementById('theme-toggle');
        const sidebarToggle = document.getElementById('sidebar-toggle');
        const sidebarOverlay = document.getElementById('sidebar-overlay');

        // ===== INITIALIZATION =====
        function init() {
            loadProgress();
            loadNotes();
            renderSidebar();
            renderContent(currentPhaseId, currentTopicId);
            updateProgressDisplay();
            setupEventListeners();
            setupSmoothScrolling();
        }

        // ===== PROGRESS MANAGEMENT =====
        function loadProgress() {
            const saved = localStorage.getItem('hackerRoadmapProgress');
            if (saved) {
                progress = JSON.parse(saved);
            } else {
                // Initialize all topics as not completed
                roadmapData.phases.forEach(phase => {
                    phase.topics.forEach(topic => {
                        if (!progress[topic.id]) {
                            progress[topic.id] = false;
                        }
                    });
                });
                saveProgress();
            }
        }

        function saveProgress() {
            localStorage.setItem('hackerRoadmapProgress', JSON.stringify(progress));
            updateProgressDisplay();
        }

        function updateProgressDisplay() {
            const totalTopics = Object.keys(progress).length;
            const completedTopics = Object.values(progress).filter(v => v).length;
            const percentage = totalTopics > 0 ? Math.round((completedTopics / totalTopics) * 100) : 0;
            
            progressFill.style.width = `${percentage}%`;
            progressText.textContent = `${percentage}% Complete`;
        }

        function toggleTopicCompletion(topicId) {
            progress[topicId] = !progress[topicId];
            saveProgress();
            
            // Update checkbox in sidebar if it exists
            const checkbox = document.querySelector(`input[data-topic="${topicId}"]`);
            if (checkbox) {
                checkbox.checked = progress[topicId];
            }
        }

        // ===== NOTES MANAGEMENT =====
        function loadNotes() {
            const saved = localStorage.getItem('hackerRoadmapNotes');
            userNotes = saved || '';
        }

        function saveNotes() {
            localStorage.setItem('hackerRoadmapNotes', userNotes);
        }

        // ===== SIDEBAR RENDERING =====
        function renderSidebar() {
            phasesList.innerHTML = '';
            
            roadmapData.phases.forEach(phase => {
                const phaseElement = document.createElement('div');
                phaseElement.className = 'phase-item';
                
                const completedInPhase = phase.topics.filter(t => progress[t.id]).length;
                const totalInPhase = phase.topics.length;
                
                phaseElement.innerHTML = `
                    <div class="phase-header ${phase.id === currentPhaseId ? 'active' : ''}" 
                         data-phase="${phase.id}">
                        <div class="phase-title">${phase.title}</div>
                        <div class="phase-progress">${completedInPhase}/${totalInPhase}</div>
                    </div>
                    <div class="topics-list ${phase.id === currentPhaseId ? 'expanded' : ''}">
                        ${phase.topics.map(topic => `
                            <div class="topic-item ${topic.id === currentTopicId ? 'active' : ''}" 
                                 data-phase="${phase.id}" 
                                 data-topic="${topic.id}">
                                <label class="checkbox-item">
                                    <input type="checkbox" 
                                           data-topic="${topic.id}"
                                           ${progress[topic.id] ? 'checked' : ''}>
                                    <span>${topic.title}</span>
                                </label>
                            </div>
                        `).join('')}
                    </div>
                `;
                
                phasesList.appendChild(phaseElement);
            });
            
            // Add event listeners to phase headers
            document.querySelectorAll('.phase-header').forEach(header => {
                header.addEventListener('click', function() {
                    const phaseId = this.getAttribute('data-phase');
                    const topicsList = this.nextElementSibling;
                    
                    // Toggle expansion
                    topicsList.classList.toggle('expanded');
                    
                    // Update active state
                    document.querySelectorAll('.phase-header').forEach(h => h.classList.remove('active'));
                    this.classList.add('active');
                    
                    currentPhaseId = phaseId;
                });
            });
            
            // Add event listeners to topic items
            document.querySelectorAll('.topic-item').forEach(item => {
                item.addEventListener('click', function(e) {
                    // Don't trigger if checkbox was clicked
                    if (e.target.type === 'checkbox') return;
                    
                    const phaseId = this.getAttribute('data-phase');
                    const topicId = this.getAttribute('data-topic');
                    
                    // Update active states
                    document.querySelectorAll('.topic-item').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    document.querySelectorAll('.phase-header').forEach(h => h.classList.remove('active'));
                    document.querySelector(`.phase-header[data-phase="${phaseId}"]`).classList.add('active');
                    
                    // Expand the phase if collapsed
                    const topicsList = this.parentElement;
                    topicsList.classList.add('expanded');
                    
                    // Load content
                    renderContent(phaseId, topicId);
                    
                    // Update current state
                    currentPhaseId = phaseId;
                    currentTopicId = topicId;
                    
                    // Close sidebar on mobile
                    if (window.innerWidth < 1024) {
                        sidebar.classList.remove('active');
                        sidebarOverlay.style.display = 'none';
                    }
                });
            });
            
            // Add event listeners to checkboxes
            document.querySelectorAll('input[type="checkbox"][data-topic]').forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    const topicId = this.getAttribute('data-topic');
                    toggleTopicCompletion(topicId);
                });
            });
        }

        // ===== CONTENT RENDERING =====
        function renderContent(phaseId, topicId) {
            const phase = roadmapData.phases.find(p => p.id === phaseId);
            const topic = phase.topics.find(t => t.id === topicId);
            
            if (!topic) return;
            
            const content = topic.content;
            
            // Build exercises HTML
            const exercisesHTML = content.exercises ? content.exercises.map(ex => `
                <div class="exercise">
                    <div class="exercise-header">
                        <h4>${ex.description}</h4>
                        <span class="exercise-level level-${ex.level}">${ex.level.toUpperCase()}</span>
                    </div>
                    <p class="exercise-goal">üéØ <strong>Goal:</strong> ${ex.goal}</p>
                    ${ex.expected ? `<p class="exercise-expected">üìù <strong>Expected Outcome:</strong> ${ex.expected}</p>` : ''}
                </div>
            `).join('') : '';
            
            // Build examples HTML
            const examplesHTML = content.examples ? content.examples.map(ex => `
                <div class="callout callout-example">
                    <h4>üîç ${ex.title}</h4>
                    <p>${ex.description}</p>
                </div>
            `).join('') : '';
            
            // Build the complete content
            mainContent.innerHTML = `
                <article class="content-section fade-in">
                    <h1>${topic.title}</h1>
                    
                    ${content.explanation || ''}
                    
                    ${content.whyItMatters || ''}
                    
                    ${content.misconceptions || ''}
                    
                    ${content.mentalModels || ''}
                    
                    ${examplesHTML}
                    
                    ${exercisesHTML ? `<h3>üß™ Practical Exercises</h3>${exercisesHTML}` : ''}
                    
                    <div class="mt-4">
                        <button onclick="toggleTopicCompletion('${topicId}')" class="primary">
                            ${progress[topicId] ? '‚úì Mark as Incomplete' : '‚úì Mark as Complete'}
                        </button>
                    </div>
                </article>
                
                <section class="notes-section">
                    <h3><span>üìù</span> Personal Notes for "${topic.title}"</h3>
                    <textarea class="notes-textarea" id="current-notes" 
                              placeholder="Record your insights, observations, and learning notes here...">${userNotes}</textarea>
                    <div>
                        <button onclick="saveCurrentNotes()" class="success">Save Notes</button>
                        <button onclick="clearNotes()" class="mt-1">Clear Notes</button>
                    </div>
                    <p class="text-center mt-2" style="color: var(--text-tertiary); font-size: 0.9rem;">
                        Notes are automatically saved to your browser's local storage.
                    </p>
                </section>
            `;
            
            // Update notes textarea with current topic's notes if we had per-topic notes
            // For now, using global notes
        }

        // ===== NOTES FUNCTIONS =====
        function saveCurrentNotes() {
            const notesTextarea = document.getElementById('current-notes');
            if (notesTextarea) {
                userNotes = notesTextarea.value;
                saveNotes();
                
                // Show confirmation
                const button = event.target;
                const originalText = button.textContent;
                button.textContent = '‚úì Saved!';
                button.style.backgroundColor = 'var(--accent-green)';
                button.style.color = '#000';
                
                setTimeout(() => {
                    button.textContent = originalText;
                    button.style.backgroundColor = '';
                    button.style.color = '';
                }, 1500);
            }
        }

        function clearNotes() {
            if (confirm('Are you sure you want to clear all notes? This cannot be undone.')) {
                userNotes = '';
                localStorage.removeItem('hackerRoadmapNotes');
                const notesTextarea = document.getElementById('current-notes');
                if (notesTextarea) {
                    notesTextarea.value = '';
                }
            }
        }

        // ===== THEME MANAGEMENT =====
        function toggleTheme() {
            currentTheme = currentTheme === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', currentTheme);
            localStorage.setItem('hackerRoadmapTheme', currentTheme);
            
            // Update toggle button
            themeToggle.textContent = currentTheme === 'dark' ? 'üåì' : 'üåû';
        }

        function loadTheme() {
            const saved = localStorage.getItem('hackerRoadmapTheme');
            if (saved) {
                currentTheme = saved;
                document.documentElement.setAttribute('data-theme', currentTheme);
                themeToggle.textContent = currentTheme === 'dark' ? 'üåì' : 'üåû';
            }
        }

        // ===== SMOOTH SCROLLING =====
        function setupSmoothScrolling() {
            // Add smooth scrolling for anchor links
            document.addEventListener('click', function(e) {
                if (e.target.matches('a[href^="#"]')) {
                    e.preventDefault();
                    const id = e.target.getAttribute('href').substring(1);
                    const element = document.getElementById(id);
                    if (element) {
                        element.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                }
            });
        }

        // ===== EVENT LISTENERS =====
        function setupEventListeners() {
            // Theme toggle
            themeToggle.addEventListener('click', toggleTheme);
            
            // Sidebar toggle for mobile
            sidebarToggle.addEventListener('click', () => {
                sidebar.classList.toggle('active');
                sidebarOverlay.style.display = sidebar.classList.contains('active') ? 'block' : 'none';
            });
            
            // Close sidebar when clicking overlay
            sidebarOverlay.addEventListener('click', () => {
                sidebar.classList.remove('active');
                sidebarOverlay.style.display = 'none';
            });
            
            // Handle window resize
            window.addEventListener('resize', () => {
                if (window.innerWidth >= 1024) {
                    sidebar.classList.remove('active');
                    sidebarOverlay.style.display = 'none';
                }
            });
            
            // Handle Escape key to close sidebar
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && sidebar.classList.contains('active')) {
                    sidebar.classList.remove('active');
                    sidebarOverlay.style.display = 'none';
                }
            });
        }

        // ===== INITIAL RENDER =====
        document.addEventListener('DOMContentLoaded', function() {
            loadTheme();
            init();
            
            // Render first topic by default
            if (roadmapData.phases.length > 0 && roadmapData.phases[0].topics.length > 0) {
                renderContent('phase-0', 'topic-0-1');
            }
        });

        // ===== GLOBAL FUNCTIONS FOR HTML CALLS =====
        window.toggleTopicCompletion = toggleTopicCompletion;
        window.saveCurrentNotes = saveCurrentNotes;
        window.clearNotes = clearNotes;
        window.renderContent = renderContent;
    </script>
</body>
</html>